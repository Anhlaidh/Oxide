<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Java笔记02 | Oxide</title>
<meta name="keywords" content="first" />
<meta name="description" content="Desc Text.">
<meta name="author" content="Me">
<link rel="canonical" href="http://blog.oxide.ink/posts/test007/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.97a8d9e5145d35197b259e1b4b69375aae58b5f148b0b90f71d1eb5cb9782e0d.css" integrity="sha256-l6jZ5RRdNRl7JZ4bS2k3Wq5YtfFIsLkPcdHrXLl4Lg0=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://blog.oxide.ink/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://blog.oxide.ink/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://blog.oxide.ink/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://blog.oxide.ink/apple-touch-icon.png">
<link rel="mask-icon" href="http://blog.oxide.ink/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.83.1" />
<link rel="alternate" hreflang="zh" href="http://blog.oxide.ink/posts/test007/" />
<link rel="alternate" hreflang="en" href="http://blog.oxide.ink/en/posts/test007/" />

<script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
              delimiters: [
                  {left: "$$", right: "$$", display: true},
                  {left: "$", right: "$", display: false}
              ]
          });
    });
</script>


<script src="https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/contrib/auto-render.min.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script><meta property="og:title" content="Java笔记02" />
<meta property="og:description" content="Desc Text." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://blog.oxide.ink/posts/test007/" />
<meta property="og:image" content="http://blog.oxide.ink/%3Cimage%20path/url%3E" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-08T16:59:00&#43;08:00" />
<meta property="article:modified_time" content="2021-06-08T16:59:00&#43;08:00" /><meta property="og:site_name" content="Oxide" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://blog.oxide.ink/%3Cimage%20path/url%3E" />
<meta name="twitter:title" content="Java笔记02"/>
<meta name="twitter:description" content="Desc Text."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://blog.oxide.ink/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Java笔记02",
      "item": "http://blog.oxide.ink/posts/test007/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Java笔记02",
  "name": "Java笔记02",
  "description": "Desc Text.",
  "keywords": [
    "first"
  ],
  "articleBody": "Maven Junit 测试   单元测试：对软件中最小可测试单元进行检查和验证，通常是一个函数/方法（属于白盒测试）\n 集成测试： 将多个单元相互作用，形成一个整体，对整体协调性进行测试    白盒测试： 全面了解程序内部逻辑结构，对所有的逻辑路径都进行测试，一般由程序员完成\n 黑盒测试：又名功能测试，将程序看作不可打开的盒子，一般由独立使用者完成    自动测试：用程序批量、反复的测试程序，并可自动检查程序结果是否满足预定的要求\n 手动测试：手动执行程序，手动输入所需要的参数，手动检查程序结果是否满足预定的要求    回归测试：修改旧代码后，重新进行测试以确认修改没有引入新的错误或导致其他代码产生错误\n  深入学习：软件测试-基于问题驱动模式 朱少民\n  Junit   import static 导入该包内的所有静态方法，使用时可不加类名\n  Triangle\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  package JavaLearning_Advanced.Maven; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 13:42 */ public class Triangle { public boolean judgeEdges(int a, int b, int c) { boolean result = true; //边长非负性  if (a  0 || b  0 || c  0) { return false; } //两边和大于第三边  if (a+bc) { return false;} if (b+ca) { return false;} if (c+ab) { return false;} return true; } }    testTriangle  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  import JavaLearning_Advanced.Maven.Triangle; import org.junit.Test; import static org.junit.Assert.*; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 13:44 */ public class testTriangle { @Test public void test() { assertEquals(false,new Triangle().judgeEdges(1,2,3)); } }    深入学习：Junit实战（第二版），PetarTahchiey  Java字符编码  尽可能使用UTF-8 读取写入编码保持一致  国际化   Locale 方法\n getAvailableLocales()获取所有可用的locale getDefault()返回默认的Locale    native2ascii.exe\n  ResourceBundle\n 根据Locale要求，加载语言文件 存储语言集合中的K-V对 getString(String key) 返回对应的value    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  package JavaLearning_Advanced.International; import java.util.Locale; import java.util.ResourceBundle; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 14:34 */ public class HelloWorld { public static void main(String[] args) { //取得系统默认的国家/语言环境  Locale myLocale = Locale.getDefault(); System.out.println(myLocale);//zh_CN  //根据指定语言，国家环境，加载资源文件  ResourceBundle bundle = ResourceBundle.getBundle(\"message\", myLocale); //从资源文件中获取信息  System.out.println(bundle.getString(\"hello\")); } }   高级字符编码 正则表达式   学习正则表达式： 精通正则表达式（第三版） Jefferry E.F.Friedl\n  java.util.regex包\n Pattern 正则表达式的编译表示  compile编译一个正则表达式喂Pattern对象 matcher用Pattern对象匹配一个字符串，返回匹配结果   Matcher  IndexMethod(位置方法) //start(),start(int group),end(),end(group) StudyMethod(查找方法) //lookingAt(),find(),find(int start),matches() Replacement(替换方法) //replaceAll(String replacement)      Matcher\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  package JavaLearning_Advanced.regex; import java.util.regex.Matcher; import java.util.regex.Pattern; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 19:21 */ public class MatcherDemo { private static final String REGEX = \"\\\\bdog\\\\b\";//\\b表示边界  private static final String INPUT = \"dog dog dog doggie dogg\"; public static void main(String[] args) { //检查字符串里有多少个dog  Pattern pattern = Pattern.compile(REGEX); Matcher matcher = pattern.matcher(INPUT); int count = 0; while (matcher.find()) { count++; System.out.println(\"Match number\" + count); System.out.println(\"start()\" + matcher.start()); System.out.println(\"end()\" + matcher.end()); // String f = \"fooooooooooooo\"; // matcher.lookingAt();//不完全匹配,匹配foo为true // matcher.find();//完全匹配，匹配foo为false  } } }   Replace\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  package JavaLearning_Advanced.regex; import java.util.regex.Matcher; import java.util.regex.Pattern; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 19:39 */ public class ReplaceDemo { public static void Replace_1() { String REGEX = \"a*b\";//*表示限定前面的a可以有0个或者多个  String INPUT = \"aavfooabfooabafoobcdd\"; String REPLACE = \"-\"; Pattern pattern = Pattern.compile(REGEX); Matcher matcher = pattern.matcher(INPUT); StringBuffer stringBuffer = new StringBuffer(); // 全部替换  while (matcher.find()) { matcher.appendReplacement(stringBuffer, REPLACE); } //最后将尾巴字符串附加上  matcher.appendTail(stringBuffer); System.out.println(stringBuffer.toString()); } public static void Replace_2() { String REGEX = \"dog\";//*表示限定前面的a可以有0个或者多个  String INPUT = \"The dog says meow.All dogs say meow\"; String REPLACE = \"cat\"; Pattern pattern = Pattern.compile(REGEX); Matcher matcher = pattern.matcher(INPUT); INPUT = matcher.replaceAll(REPLACE); System.out.println(INPUT); } }    OJ  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  package JavaLearning_Advanced.regex; import org.apache.commons.io.Charsets; import org.apache.commons.io.IOUtils; import java.io.InputStream; import java.nio.charset.Charset; import java.util.LinkedList; import java.util.List; import java.util.Scanner; /** * @Description: * @author: Anhlaidh * @date: 2020/3/23 0023 19:55 */ public class String2inputStream { public static void main(String[] args) { //构造字符串列表  ListString names = new LinkedList(); names.add(\"xiaohong\"); names.add(\"xiaoming\"); names.add(\"Daming\"); names.add(\"xiaohei\"); //合并为一个字符串，以逗号相连  String nameStr = String.join(\",\", names); //将字符串作为默认输入流  InputStream in = IOUtils.toInputStream(nameStr, Charsets.toCharset(\"UTF-8\")); //重置系统的输入流  System.setIn(in); //模拟键盘输入，这也是OJ平台测试用例输入的原理  //此处也可以换成一个文件的输入流  Scanner scanner = new Scanner(System.in); scanner.useDelimiter(\",\"); while (scanner.hasNext()) { System.out.println(scanner.next()); } } }   xml  常规语法  任何的起始标签都必须有一个结束标签 简化写法，例如，可以写为 大小写敏感，name和Name不一样 每个文件都要有一个根元素 标签必须按合适的顺序进行嵌套，不可错位 所有的特性都必须有值，且在值的周围加上引号 需要转义字符，如\"    转义 符号 意思     \u0026lt;  小于   \u0026gt;  大于   \u0026amp; \u0026 和号   \u0026apos; ' 单引号   \u0026quot; \" 双引号       注释：    xml解析 未完成\nJSON  概念  JavaScript Object Notation ，JS对象表示法 是一种轻量级的数据交换格式 类似XML，更小、更快、更易解析 最早用于JavaScript中，容易解析，最后推广到全语言 尽管使用JavaScript语法，但是独立于编程语言   用途  JSON生成 JSON解析 JSON校验 和JavaBean对象进行互解析  具有一个无参的构造函数 可以包括多个属性，所有属性都是private 每个属性都有对应的Getter/Setter方法 JavaBean 用于封装数据，有可称为POJO(Plain Old notes.Java Object)      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60  package JavaLearning_Advanced.Json; import com.fasterxml.jackson.core.type.TypeReference; import com.fasterxml.jackson.databind.JsonNode; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.File; import java.io.IOException; import java.util.Arrays; import java.util.List; /** * @Description: * @author: Anhlaidh * @date: 2020/3/26 0026 21:42 */ public class testJackson { public static void main(String[] args) throws IOException { testJsonObject(); System.out.println(\"分割线=====================================================\"); testJsonFile(); } private static void testJsonFile() throws IOException { ObjectMapper objectMapper = new ObjectMapper(); //从json文件中加载，并重构为java对象  File json = new File(\"temp/json/books.json\"); ListBook books = objectMapper.readValue(json, new TypeReferenceListBook() { }); for (Book book : books) { System.out.println(book.getAuthor()); System.out.println(book.getTitle()); } } private static void testJsonObject() throws IOException { ObjectMapper objectMapper = new ObjectMapper(); //构造对象  Person person = new Person(); person.setName(\"TOM\"); person.setAge(20); person.setScores(Arrays.asList(60, 70, 80)); //将对象解析为json字符串  String jsonStr = objectMapper.writeValueAsString(person); System.out.println(jsonStr); //json字符串重构对象  Person p2 = objectMapper.readValue(jsonStr, Person.class); System.out.println(p2.getName()); System.out.println(p2.getAge()); System.out.println(p2.getScores()); //从json字符串重构JsonNode对象  JsonNode node = objectMapper.readTree(jsonStr); System.out.println(node.get(\"name\").asText()); System.out.println(node.get(\"age\").asText()); System.out.println(node.get(\"scores\")); } }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  [ { \"category\": \"COOKING\", \"tools.title\": \"Everyday Italian\", \"author\": \"Giada De Laurentiis\", \"year\": \"2005\", \"price\": 30 }, { \"category\": \"CHILDREN\", \"tools.title\": \"Harry Potter\", \"author\": \"J K Rowling\", \"year\": \"2005\", \"price\": 29 }, { \"category\": \"WEB\", \"tools.title\": \"Learning XML\", \"author\": \"Erik T.Ray\", \"year\": \"2003\", \"price\": 39 } ]    总结  JSON是一种独立于编程语言的、轻量的、数据交换格式 有多种第三方库辅助我们进行JSON生成和解析 JSON会丢失顺序性    图片 - imageIO\r- 验证码\r 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73  package JavaLearning_Advanced.picture; import javax.imageio.ImageIO; import java.awt.*; import java.awt.image.BufferedImage; import java.io.File; import java.io.IOException; import java.util.Random; /** * @Description: * @author: Anhlaidh * @date: 2020/3/28 0028 19:56 */ public class ValidateCode { static char[] codeSequence= {'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','2','3','4','5','6','7','8','9'}; static int charNum = codeSequence.length; public static void main(String[] args) throws IOException { generateCode(\"./temp/validateCode/code.jpg\"); } private static void generateCode(String filePath) throws IOException { //首先定义验证码图片库  int width = 140;//验证码图片的宽度  int height = 40;//验证码图片的高度  BufferedImage bufferedImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB); //定义图片上的图形和干扰线  Graphics2D graphics2D = bufferedImage.createGraphics(); graphics2D.setColor(Color.GRAY);//将图像填充为浅灰色  graphics2D.fillRect(0, 0, width, height); graphics2D.setColor(Color.BLACK);//画边框  graphics2D.drawRect(0, 0, width - 1, height - 1); //随机产生16条灰色干扰线  graphics2D.setColor(Color.darkGray); //创建一个随机数生成器类，用于随机产生干扰线  Random random = new Random(); for (int i = 0; i  16; i++) { int x = random.nextInt(width); int y = random.nextInt(height); int x1 = random.nextInt(50); int y1 = random.nextInt(50); graphics2D.drawLine(x, y, x1, y1); } //计算字的位置坐标  int codeCount = 4;//字的个数  int fontHeight ;//字体高度  int codeX;//第一个字符的x坐标，因为后面的字符坐标依次递增，所以他们的x轴值是codeX+i的值  int codeY;//验证字符的y坐标，因为并排所以值一样  //width-4除去左右多余的位置，使验证码更加集中显示，减的越多越集中  //codeCount+1//等比分配显示的宽度，包括左右两边的空格  codeX = (width - 4) / (codeCount + 1);//第一个字母的起始位置  fontHeight = height - 10;//height-10高度中间区域显示验证码  codeY = height - 7; //创建字体，字体的大小应该根据图片的高度来定  Font font = new Font(\"Fixedsys\", Font.PLAIN, fontHeight); graphics2D.setFont(font); //随机产生codeCount数字的验证码  for (int i = 0; i  codeCount; i++) { //每次随机拿一个字母，赋予随机的颜色  String strRand = String.valueOf(codeSequence[random.nextInt(charNum)]); int red = random.nextInt(255); int blue = random.nextInt(255); int green = random.nextInt(255); graphics2D.setColor(new Color(red, green, blue)); //把字放到图片上  graphics2D.drawString(strRand, (i + 1) * codeX, codeY); } ImageIO.write(bufferedImage, \"jpg\", new File(filePath)); } }   多进程和多线程 概念 多进程  当前的操作系统都是多任务OS 每个独立执行的任务就是一个进程 OS将时间划分为多个时间片（时间很短） 每个时间片内将CPU分配给某一个任务，时间片结束，CPU自动回收，再分配给另外任务。从外部看，所有任务都是同时在执行。 但是在CPU上，任务是按照串行依次运行（单核CPU ）。如果多核，多个进程任务可以并行。但是单个核上，多进程只能串行执行 多进程的优点  可以同时运行多个任务 程序因IO堵塞时，可以释放CPU，让CPU为其他程序服务 当系统有多个CPU时，可以为多个程序同时服务  我们的CPU不再提高频率，而是提高核数 多核和并行程序才是提高程序性能的唯一办法     多进程的缺点  太笨重，不好管理 太笨重，不好切换    多线程  一个程序可以包括多个子任务，可串/并行 每个子任务可以称为一个线程 如果一个子任务阻塞，程序可以将CPU调度另外一个子任务进行工作，这样CPU还是保留在本程序中，而不是被调度到别的程序（进程）去， 这样，提高本程序获得CPU时间和利用率  启动  start方法，会自动以新进程调用run方法 直接调用run方法，会编程串行执行 同一个线程，多次start会报错，只执行第一次start方法 多个线程启动，其启动的先后顺序是随机的 线程无需关闭，只要其run方法执行结束后，自动关闭 main函数（线程）可能早于新线程结束，整个程序并不终止 整个程序终止是等所有的线程都终止（包括main函数线程）  ####多线程实现的对比\n Thread占据了父类名额，不如Runnable方便 Thread类实现Runnable Runnable启动时需要Thread类的支持 Runnable更容易实现多线程中资源共享  结论：建议实现Runnable接口来完成多线程\n规则 规则一： 1.调用run方法来启动run方法，将会是串行运行 2. 调用start方法，来启动run方法，将会是并行运行（多线程运行） 规则二：\n main线程可能早于子线程结束 main线程和子线程都结束了，整个程序才算终止 规则三： 1.实现Runnable的对象必须包装在Thread类里面，才可以启 不能直接对Runnable对象进行start方法 规则四： 一个线程对象不能多次start，多次start将报异常 多个线程对象都start后，哪一个先执行，完全由JVM/操作系统来主导，程序员无法指定  一：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  package JavaLearning_Advanced.thread.rules; /** * @Description: * 规则一： * 1.调用run方法来启动run方法，将会是串行运行 * 2. 调用start方法，来启动run方法，将会是并行运行（多线程运行） * * @author: Anhlaidh * @date: 2020/3/28 0028 22:59 */ public class first { public static void main(String[] args) throws InterruptedException { new TestThread0().run(); while (true) { System.out.println(\"main\"); Thread.sleep(10); } } } class TestThread0 extends Thread{ @Override public void run() { while (true) { System.out.println(\"testThread0\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } } } }   二：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  package JavaLearning_Advanced.thread.rules; /** * @Description: * 规则二： * 1. main线程可能早于子线程结束 * 2. main线程和子线程都结束了，整个程序才算终止 * @author: Anhlaidh * @date: 2020/3/28 0028 23:06 */ public class second { public static void main(String[] args) throws InterruptedException { new TestThread1().start(); // while (true) { // System.out.println(\"main\"); // Thread.sleep(10); // }  } } class TestThread1 extends Thread{ @Override public void run() { while (true) { System.out.println(\"testThread1\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } } } }   三:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  package JavaLearning_Advanced.thread.rules; /** * @Description: * 规则三： * 1.实现Runnable的对象必须包装在Thread类里面，才可以启动 * 2. 不能直接对Runnable对象进行start方法 * @author: Anhlaidh * @date: 2020/3/28 0028 23:33 */ public class third { public static void main(String[] args) throws InterruptedException { // new TestThread2().start();  //runnable对象必须放在一个Thread类中才能运行  TestThread2 tt = new TestThread2(); Thread thread = new Thread(tt); thread.start(); while (true) { System.out.println(\"main\"); Thread.sleep(1000); // }  } } } class TestThread2 implements Runnable { @Override public void run() { while (true) { System.out.println(Thread.currentThread().getName()); //输出当前线程名  try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } } } }   四：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  package JavaLearning_Advanced.thread.rules; /** * @Description: * 规则四： * 1. 一个线程对象不能多次start，多次start将报异常 * 2. 多个线程对象都start后，哪一个先执行，完全由JVM/操作系统来主导，程序员无法指定 * @author: Anhlaidh * @date: 2020/3/28 0028 23:39 */ public class Fourth { public static void main(String[] args) { TestThread4 t1 = new TestThread4(); t1.start(); // t1.start();  TestThread4 t2 = new TestThread4(); t2.start(); } } class TestThread4 extends Thread { @Override public void run() { while (true) { System.out.println(Thread.currentThread().getName()+\"is running\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } } } }   多进程和多线程的对比  线程共享数据 线程通讯更高效 线程更轻量级，更容易切换 多个线程更容易管理  多线程信息共享  线程类  通过继承Thread或实现Runnable 通过start方法，调用run方法，run方法工作 线程run结束后，线程退出   粗粒度：子线程与子线程之间、和main线程之间缺乏交流 细粒度：线程之间有信息交流通讯  通过共享变量达到信息共享 Jdk原生库不支持发送消息   通过共享变量在多个线程中共享消息  static变量 同一个Runnable类的成员变量    test1:继承thread，static修饰的变量可以共享，但是会造成数据重复\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  package JavaLearning_Advanced.thread.message; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 20:23 */ public class ThreadDemo0 { public static void main(String[] args) { new TestThread0().start(); new TestThread0().start(); new TestThread0().start(); new TestThread0().start(); } private static class TestThread0 extends Thread { // private int tickets = 100; 每个线程卖100张，没有共享  private static int tickets = 100; //static变量是共享的，所有的线程共享  @Override public void run() { while (tickets0) { System.out.println(Thread.currentThread().getName() + \" is selling tickets\" + tickets); tickets = tickets - 1; } } } }    多线程信息共享问题  工作缓存副本 关键步骤缺乏加锁限制   i++，并非原子性操作  读取主存i（正本）到工作缓存（副本）中 每个CPU执行（副本）i+1操作 CPU将结果写入到缓存（副本）中 数据从工作缓存（副本）刷到主存（正本）中   变量副本问题的解决办法  采用volatile关键字修饰变量 保证不同线程对共享变量操作时的可见性    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  package JavaLearning_Advanced.thread.message; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 20:55 */ public class ThreadDemo2 { public static void main(String[] args) throws InterruptedException { TestTread3 testTread3 = new TestTread3(); testTread3.start(); Thread.sleep(1000); testTread3.flag = false; System.out.println(\"main thread is exiting\"); } private static class TestTread3 extends Thread { // boolean flag = true;//子线程不会停止  volatile boolean flag = true;//用volatile修饰的变量可以及时在各线程里面通知  @Override public void run() { int i = 0; while (flag) { i++; } System.out.println(\"test thread is exiting\"); } } }    关键步骤加锁限制  互斥：某一个线程运行一个代码段（关键区），其他线程不能同时运行这个代码段 同步：多个线程的运行，必须按照某一种规定的先后顺序来运行 互斥是同步的一种特例   互斥的关键字是synchronized  synchronized代码块/函数，只能一个线程进入 synchronized能加大性能负担，但是使用简便    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  package JavaLearning_Advanced.thread.message; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 21:16 */ public class ThreadDemo3 { public static void main(String[] args) { TestThread3 testThread3 = new TestThread3(); new Thread(testThread3).start(); new Thread(testThread3).start(); new Thread(testThread3).start(); new Thread(testThread3).start(); } private static class TestThread3 implements Runnable { private volatile int tickets = 100; @Override public void run() { while (tickets0) { sale(); try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } } } private synchronized void sale() { System.out.println(Thread.currentThread().getName() + \" sale \" + tickets--); } } }   多线程管理   线程状态\n NEW 刚创建（new） RUNNABLE就绪态（start） RUNNING运行中（run） BLOCK阻塞（sleep） TERMINATED 结束    Thread的部分API已经废弃\n 暂停和恢复：suspend/resume 消亡：stop/destroy    线程阻塞/和唤醒\n sleep，时间一到，自己就会醒来 wait/notify/notifyAll，等待，需要别人来唤醒 join，等待另一个线程结束 interrupt，向另外一个线程发送中断信号，该线程收到信号，会触发 Interrupted Exception（可接触阻塞），并进入下一步处理    线程类\n  主动interrupt\n  被动interrupt\n  多线程死锁\n 每个线程相互持有别人需要的锁（哲学家吃面问题） 预防死锁，对资源进行等级排序    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55  package JavaLearning_Advanced.thread.Interrupt; import java.util.concurrent.TimeUnit; /** * @Description: * @author: Anhlaidh * @date: 2020/4/7 0007 22:05 */ public class DeadLock { public static Integer r1 = 1; public static Integer r2 = 2; public static void main(String[] args) { Thread1 t1 = new Thread1(); t1.start(); Thread2 t2 = new Thread2(); t2.start(); } } class Thread1 extends Thread { @Override public void run() { //先要r1再要r2  synchronized (DeadLock.r1) { try { TimeUnit.SECONDS.sleep(3); } catch (InterruptedException e) { e.printStackTrace(); } synchronized (DeadLock.r2) { System.out.println(\"Thread1 is running\"); } } } } class Thread2 extends Thread { @Override public void run() { //先要r2再要r1  synchronized (DeadLock.r2) { try { TimeUnit.SECONDS.sleep(3); } catch (InterruptedException e) { e.printStackTrace(); } synchronized (DeadLock.r1) { System.out.println(\"Thread2 is running\"); } } } }    守护（后台）线程  普通线程的结束，是run方法运行结束 守护线程的结束，是run方法运行结束，或main函数结束 守护线程永远不要访问资源，如文件或数据库等    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  package JavaLearning_Advanced.thread.Interrupt; /** * @Description: * @author: Anhlaidh * @date: 2020/4/7 0007 22:19 */ public class protect { public static void main(String[] args) throws InterruptedException { Thread3 t = new Thread3(); t.setDaemon(true); t.start(); Thread.sleep(2000); System.out.println(\"main thread is exiting\"); } } class Thread3 extends Thread { @Override public void run() { while (true) { try { Thread.sleep(300); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"running\"); } } }    线程查看工具jvisualvm  并发框架   业务：任务多，数据量大\n  串行 并行\n 串行编程简单，并行编程困难 单个计算核频率下降，计算核数增多，整体性能变高    并行困难（任务分配和执行过程高度耦合）\n 如何控制粒度，切割任务 如何分配任务给线程，监督线程执行过程    并行计算  并行模式  主从模式(Master-Slave) Worker模式(Worker-Worker)   Java并发编程  Thread/Runnable/Thread组管理 Executor(重点) Fork-Join框架    线程组管理  线程组ThreadGroup  线程的集合 树形结构,大线程可以包括小线程组 可以通过enumerate方法遍历组内的线程,执行操作 能够有效管理多个线程,但是管理效率低 任务分配和执行过程高度耦合 重复创建线程,关闭线程操作,无法重用线程    Executor*  从jdk5开始提供Executor FrameWork  分离任务的创建和执行者的创建 线程重复利用(new线程代价很大)   理解共享线程池的概念  预设好的多个Thread,可弹性增加 多次执行很多很小的任务 任务创建和执行过程解耦 程序员无需关心线程池执行任务过程    Main:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57  package JavaLearning_Advanced.thread.Executor.example2; import java.util.ArrayList; import java.util.List; import java.util.concurrent.ExecutionException; import java.util.concurrent.Executors; import java.util.concurrent.Future; import java.util.concurrent.ThreadPoolExecutor; /** * @Description: * @author: Anhlaidh * @date: 2020-04-08 22:15 */ public class SumTest { public static void main(String[] args) { //执行线程池  ThreadPoolExecutor executor = (ThreadPoolExecutor) Executors.newFixedThreadPool(8); ListFutureInteger resultList = new ArrayList(); //统计1-1000总和,分成10个任务计算,提交任务  for (int i = 0; i  10; i++) { SumTask calculator = new SumTask(i*100+1,(i+1)*100); FutureInteger result = executor.submit(calculator); resultList.add(result); } //每隔50毫秒,轮询等待10个任务结束  do { System.out.printf(\"Main:已经完成了多少个任务:%d\\n\", executor.getCompletedTaskCount()); for (int i = 0; i  resultList.size(); i++) { FutureInteger result = resultList.get(i); System.out.printf(\"Main Task %d:%s\\n\", i, result.isDone()); } try { Thread.sleep(50); } catch (InterruptedException e) { e.printStackTrace(); } } while (executor.getCompletedTaskCount()  resultList.size()); //所有任务都已经结束,综合计算结果  int total = 0; for (int i = 0; i  resultList.size(); i++) { FutureInteger result = resultList.get(i); Integer sum = null; try { sum = result.get(); total = total + sum; } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); } } System.out.println(\"1-1000的总和\" + total); } }   SumTask:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  package JavaLearning_Advanced.thread.Executor.example2; import java.util.Random; import java.util.concurrent.Callable; /** * @Description: * @author: Anhlaidh * @date: 2020-04-08 22:17 */ public class SumTask implements Callable { private int startNumber; private int endNumber; public SumTask(int startNumber, int endNumber) { this.startNumber = startNumber; this.endNumber = endNumber; } @Override public Integer call() throws Exception { int sum = 0; for (int i = startNumber; i  endNumber; i++) { sum = sum + i; } Thread.sleep(new Random().nextInt(1000)); System.out.printf(\"%s:%d\", Thread.currentThread().getName(), sum); return sum; } }   Fork-Join  关键类  ForkJoinPool 任务池 RecursiveAction RecursiveTask Main:    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  package JavaLearning_Advanced.thread.Fork_Join; import java.util.concurrent.ExecutionException; import java.util.concurrent.ForkJoinPool; import java.util.concurrent.ForkJoinTask; /** * @Description: * @author: Anhlaidh * @date: 2020-04-09 13:37 */ public class SumTest { public static void main(String[] args) throws ExecutionException, InterruptedException { //创建执行线程池  ForkJoinPool pool = new ForkJoinPool(8); //创建任务  SumTask task = new SumTask(1,1000000); //提交任务  ForkJoinTaskLong result = pool.submit(task); //等待结果  do { System.out.printf(\"Main:Thread Count:%d\\n\", pool.getActiveThreadCount()); System.out.printf(\"Main:Parallelism:%d\\n\", pool.getParallelism()); try { Thread.sleep(50); } catch (InterruptedException e) { e.printStackTrace(); } } while (!task.isDone()); //输出结果  System.out.println(result.get().toString()); } }   SumTask\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  package JavaLearning_Advanced.thread.Fork_Join; import java.util.concurrent.ExecutionException; import java.util.concurrent.ForkJoinPool; import java.util.concurrent.ForkJoinTask; /** * @Description: * @author: Anhlaidh * @date: 2020-04-09 13:37 */ public class SumTest { public static void main(String[] args) throws ExecutionException, InterruptedException { //创建执行线程池  ForkJoinPool pool = new ForkJoinPool(8); //创建任务  SumTask task = new SumTask(1,1000000); //提交任务  ForkJoinTaskLong result = pool.submit(task); //等待结果  do { System.out.printf(\"Main:Thread Count:%d\\n\", pool.getActiveThreadCount()); System.out.printf(\"Main:Parallelism:%d\\n\", pool.getParallelism()); try { Thread.sleep(50); } catch (InterruptedException e) { e.printStackTrace(); } } while (!task.isDone()); //输出结果  System.out.println(result.get().toString()); } }   主要类  ExecutorService,ThreadPoolExecutor,Future  Executors.newCachedThreadPool/newFixedThreadPool创建线程池 ExecutorService线程池服务 Callable 具体的逻辑对象(线程类) Future返回结果    并发数据结构  阻塞式集合:当集合为空或者满时,等待 非阻塞式集合:当集合为空或者满时,不等待,返回null或异常  -List - Vector 同步安全,写多读少 - ArrayList 不安全 - Collections.synchronizedList(List list) 基于synchronized,效率差 - CopyOnWriteArrayList 读多写少,基于复制机制,非阻塞\n Set  HashSet不安全 Collections.synchronizedSet(Set set)基于synchronized,效率差 CopyOnWriteArraySet (基于CopyOnWriteArrayList实现),读多写少,非阻塞   Map  Hashtable 同步安全,写多读少 HashMap 不安全 Collections.synchronizedMap(Map map)基于synchronized,效率差 ConcurrentHashMap,读多写少,非阻塞   Queue\u0026Deque  ConcurrentLinkedQueue非阻塞 ArrayBlockingQueue/LinkedBlockingQueue阻塞    并发协作与控制 Lock  买奶茶,读写锁,互斥锁\n  Lock也可以实现同步的效果  实现更复杂的临界区结构 tryLock方法可以预判锁是否空闲 允许分离读写的操作,多个读,一个写 性能更好   ReentrantLock 类,可重入的互斥锁 ReentrantReadWriteLock类,可重入的读写锁 lock和unlock函数  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128  package notes.Java.JavaLearning_Advanced.thread.Lock; import java.util.concurrent.locks.ReentrantLock; import java.util.concurrent.locks.ReentrantReadWriteLock; /** * @Description: * @author: Anhlaidh * @date: 2020-05-07 16:41 */ public class LockExample { private static final ReentrantLock queueLock = new ReentrantLock();//可重入锁  private static final ReentrantReadWriteLock orderLock = new ReentrantReadWriteLock();//可读写锁  /** * 有家奶茶店,点单时需要排队 * 假设想买奶茶的人如果看到需要排队就等等 * 假设奶茶店又老板和多名员工,记单方式比较原始,只有一个订单本 * 老板负责写新订单,员工不断查看订单本得到信息来制作奶茶,在老板写订单时员工不可以看订单本 * 多个员工可同时看订单本,但此时老板不可写入订单本 * @param args args */ public static void main(String[] args) { // byMilkTea();  handleOrder(); } private static void byMilkTea() { LockExample lockExample = new LockExample(); int CUSTOMER_CNT = 10; Thread[] customers = new Thread[CUSTOMER_CNT]; for (int i = 0; i  CUSTOMER_CNT; i++) { customers[i] = new Thread(new Runnable() { @Override public void run() { try { long walkingTime = (long) (Math.random() * 1000); Thread.sleep(walkingTime); lockExample.tryToBuyMilkTea(); } catch (InterruptedException e) { System.out.println(e.getMessage()); } } }); customers[i].start(); } } private void tryToBuyMilkTea() throws InterruptedException { boolean flag = true; while (flag) { if (queueLock.tryLock()) { // queueLock.lock();  long thinkingTime = (long) (Math.random() * 500); Thread.sleep(thinkingTime); System.out.println(Thread.currentThread().getName() + \":来一杯奶茶,不要珍珠\"); flag = false; queueLock.unlock(); } else { System.out.println(Thread.currentThread().getName()+\":再等等\"); } if (flag) { Thread.sleep(1000); } } } private static void handleOrder() { LockExample lockExample = new LockExample(); Thread boss = new Thread(new Runnable() { @Override public void run() { while (true) { try { lockExample.addOrder(); long waitingTime = (long) (Math.random() * 1000); Thread.sleep(waitingTime); } catch (InterruptedException e) { System.out.println(e.getMessage()); } } } }); boss.start(); int WORKER_CNT = 3; Thread[] workers = new Thread[WORKER_CNT]; for (int i = 0; i  WORKER_CNT; i++) { workers[i] = new Thread(new Runnable() { @Override public void run() { while (true) { try { lockExample.viewOrder(); long workingTime = (long) (Math.random() * 5000); Thread.sleep(workingTime); } catch (InterruptedException e) { System.out.println(e.getMessage()); } } } }); workers[i].start(); } } private void viewOrder() throws InterruptedException { orderLock.readLock().lock(); long readingTime = (long) (Math.random() * 500); Thread.sleep(readingTime); System.out.println(Thread.currentThread().getName()+\":查看订单\"); orderLock.readLock().unlock(); } private void addOrder() throws InterruptedException { orderLock.writeLock().lock(); long writingTime = (long) (Math.random() * 1000); Thread.sleep(writingTime); System.out.println(\"老板新加一笔订单\"); orderLock.writeLock().unlock(); } }   Semaphore  抢车位,车位满了不可停车,其他等着\n  信号量:由1965年Dijkstra提出 信号量:本质上是一个计数器 计数器大于0,可以使用,等于0不能使用 可以设置多个并发量,例如限制10个访问 Semaphore  acquire获取 release释放   比lock更进一步,可以控制多个同时访问关键区  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  package notes.Java.JavaLearning_Advanced.thread.Semaphore; import java.util.concurrent.Semaphore; /** * @Description: * @author: Anhlaidh * @date: 2020-05-07 17:48 */ public class SemaphoreExample { private final Semaphore placeSemaphore = new Semaphore(5); public boolean parking() { if (placeSemaphore.tryAcquire()) { System.out.println(Thread.currentThread().getName() + \"停车成功\"); return true; } else { System.out.println(Thread.currentThread().getName() + \"没有空位\"); return false; } } public void leaving() { placeSemaphore.release(); System.out.println(Thread.currentThread().getName()+\":开走\"); } /** * 一个车库,五个车位,十辆车需要停放,每次停放时,申请信号量 * @param args args * @throws InterruptedException exception */ public static void main(String[] args) throws InterruptedException { int tryToParkCnt = 10; SemaphoreExample semaphoreExample = new SemaphoreExample(); Thread[] parkers = new Thread[tryToParkCnt]; for (int i = 0; i  tryToParkCnt; i++) { parkers[i] = new Thread(new Runnable() { @Override public void run() { try { long randomTime = (long) (Math.random() * 1000); Thread.sleep(randomTime); if (semaphoreExample.parking()) { long parkingTime = (long) (Math.random() * 1000); Thread.sleep(parkingTime); semaphoreExample.leaving(); } } catch (InterruptedException e) { System.out.println(e.getMessage()); } } }); parkers[i].start(); } for (int i = 0; i  tryToParkCnt; i++) { parkers[i].join(); } } }   latch  百米赛跑,发令枪归零同时起跑(startSignal),运动员依次就位(doneSignal)\n  等待锁,是一个同步辅助类 用来同步执行任务的一个或者多个线程 不是用来保护临界区或者资源共享 CountDownLatch  countDown() 计数-1 await() 等待latch变成0    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  package notes.Java.JavaLearning_Advanced.thread.CountDownLatch; import java.util.concurrent.CountDownLatch; /** * @Description: * @author: Anhlaidh * @date: 2020-05-08 10:58 */ public class CountDownLatchExample { /** * 设想百米赛跑比赛,发令枪发出信号后选手开始跑,全部选手跑到终点后比赛结束 * @param args args * @throws InterruptedException Interrupted Exception */ public static void main(String[] args) throws InterruptedException { int runnerCnt = 10; CountDownLatch startSignal = new CountDownLatch(1); CountDownLatch doneSignal = new CountDownLatch(runnerCnt); for (int i = 0; i  runnerCnt; i++) {//create and start threads  new Thread(new Worker(startSignal,doneSignal)).start(); } System.out.println(\"准备工作\"); System.out.println(\"准备工作就绪\"); startSignal.countDown();//let all thread proceed  System.out.println(\"比赛开始\"); doneSignal.await();//wait for all to finish  } private static class Worker implements Runnable { private final CountDownLatch startSignal; private final CountDownLatch downSignal; public Worker(CountDownLatch startSignal, CountDownLatch downSignal) { this.startSignal = startSignal; this.downSignal = downSignal; } @Override public void run() { try { startSignal.await(); Thread.sleep((long)(Math.random()*500)); doWork(); downSignal.countDown(); } catch (InterruptedException e) { //return;  } } private void doWork() { System.out.println(Thread.currentThread().getName()+\":跑完全程\"); } } }   Barrier  分步计算总和\n  集合点,也是一个同步辅助类 允许多个线程在某一个点上进行同步 CyclicBarrier  构造函数是需要同步的线程数量 await等待其他线程,达到数量后就放行    Phaser  允许执行并发多阶段任务,同步辅助类 在每一个阶段结束的位置对线程进行同步,当所有线程都到达这步,再进行下一步 Phaser  arrive() arriveAndAwaitAdvance()    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  package notes.Java.JavaLearning_Advanced.thread.Phaser; import java.util.concurrent.Phaser; /** * @Description: * @author: Anhlaidh * @date: 2020-05-08 19:46 */ public class PhaserExample { /** * 假设举行考试,总共三个答题,每次下发一道题目,等所有学生完成后再进行下一道 * @param args */ public static void main(String[] args) { int STUDENT_CNT = 5; Phaser phaser = new Phaser(STUDENT_CNT); for (int i = 0; i  STUDENT_CNT; i++) { new Thread(new Student(phaser)).start(); } } private static class Student implements Runnable { private final Phaser phaser; public Student(Phaser phaser) { this.phaser = phaser; } @Override public void run() { try { doTesting(1); phaser.arriveAndAwaitAdvance(); doTesting(2); phaser.arriveAndAwaitAdvance(); doTesting(3); phaser.arriveAndAwaitAdvance(); } catch (InterruptedException e) { e.printStackTrace(); } } private void doTesting(int i) throws InterruptedException { String name = Thread.currentThread().getName(); System.out.println(name + \"开始第\" + i + \"题\"); long thinkingTime = (long) (Math.random() * 1000); Thread.sleep(thinkingTime); System.out.printf(\"%s第%d到题答题结束\\n\",name,i); } } }   Exchanger  双向交换数据\n  允许在并发线程中相互交换消息 允许在2个线程种定义同步点,当两个线程都达到同步点,他们交换数据结构 Exchanger  exchange(),线程双方互相交换数据 交换数据是双向的    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72  package notes.Java.JavaLearning_Advanced.thread.Exchanger; import java.util.Scanner; import java.util.concurrent.Exchanger; /** * @Description: * @author: Anhlaidh * @date: 2020-05-10 17:16 */ public class ExchangerExample { /** * 通过Exchanger实现学生成绩查询,简单线程间的数据交换 * @param args */ public static void main(String[] args) throws InterruptedException { ExchangerString exchanger = new ExchangerString(); BackgroundWorker worker = new BackgroundWorker(exchanger); new Thread(worker).start(); Scanner reader = new Scanner(System.in); while (true) { System.out.println(\"输出要查询的的属性学生姓名:\"); String input = reader.nextLine().trim(); exchanger.exchange(input); String value = exchanger.exchange(null); if (\"exit\".equals(value)) { break; } System.out.println(\"查询结果\" + value); } reader.close(); } private static class BackgroundWorker implements Runnable{ final ExchangerString exchanger; public BackgroundWorker(ExchangerString exchanger) { this.exchanger = exchanger; } @Override public void run() { while (true) { try { String item = exchanger.exchange(null); switch (item) { case \"zhangsan\": exchanger.exchange(\"90\"); break; case \"lisi\": exchanger.exchange(\"80\"); break; case \"wangwu\": exchanger.exchange(\"70\"); break; case \"exit\": exchanger.exchange(\"exit\"); default: exchanger.exchange(\"none\"); } } catch (InterruptedException e) { e.printStackTrace(); } } } } }   定时任务  简单定时机制  设置计划任务,也就是在指定的时间开始执行某一个任务 TimerTask封装任务 Timer类 定时器   Timer  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  package notes.Java.JavaLearning_Advanced.thread.Timer; import java.util.Calendar; import java.util.Date; import java.util.Timer; import java.util.TimerTask; /** * @Description: * @author: Anhlaidh * @date: 2020-05-10 17:42 */ public class TimerTest { public static void main(String[] args) throws InterruptedException { MyTask myTask = new MyTask(); Timer timer = new Timer(); System.out.println(\"当前时间:\" + new Date().toLocaleString()); //当前时间一秒后,每两秒执行一次  timer.schedule(myTask,1000,2000); Thread.sleep(10000); myTask.cancel();//取消当前任务  System.out.println(\"==============\"); Calendar now = Calendar.getInstance(); now.set(Calendar.SECOND, now.get(Calendar.SECOND) + 3); Date runDate = now.getTime(); MyTask2 myTask2 = new MyTask2(); timer.scheduleAtFixedRate(myTask2,runDate,3000); } private static class MyTask extends TimerTask { @Override public void run() { System.out.println(\"运行了!时间为:\"+new Date()); } } private static class MyTask2 extends TimerTask{ @Override public void run() { System.out.println(\"运行了!时间为:\"+new Date()); try { Thread.sleep(4000); } catch (InterruptedException e) { e.printStackTrace(); } } } }    Executor+定时器机制 ScheduledExecutorService  定时任务 周期任务   Quartz  Quartz是一个较为完善的任务调度框架 解决程序中Timer零散管理的问题 功能更加强大  Timer执行周期任务,如果中间有一次有一场,整个任务终止执行 Quartz执行周期任务,如果中间某一次有异常,不影响下次任务执行      ​\nJava网络编程 网络基础知识   网络是当前信息技术的第一推动力\n  每个计算设备上都有若干个网卡\n  每个网卡上有（全球唯一）单独的硬件地址，MAC地址\n  ip地址\n IPV4 192.169.0.1每段0-255 IPV6 128bit长，8段，每段4个16进制数 ipconfig ifconfig    port:端口 0~65535\n 0~1023OS已经占用了，80是web，23是telnet 1024~65535，一般程序可使用（谨防冲突）    两台机器通讯就是在IP+port上进行的\n netstat -an    保留ip：127.0.0.1 本机\n  公网（万维网/互联网）和内网（局域网）\n 网络上分层的 最外层的是外网/互联网 底下每层都是内网 ip地址可以在每个层次的网重用 tracert 看当前及其和目标机器的访问中继    通讯协议TCP UDP\n TCP(Transmission Control Protocol)  传输控制协议，面向连接的协议 两台机器的可靠无差错的数据传输 双向字节流传递   UDP(User Datagram Protocol) –QQ(多次UDP模仿TCP) 用户数据报协议，面向无连接协议 不保证可靠的数据传输 速度快，也可以在较差的网络下使用    UDP  计算机通讯：数据从一个IP的port出发（发送方），运输到另外一个IP的port（接收方） UDP：无连接无状态的通讯协议  发送方发送消息，如果接收方刚好在目的地，则可以接受，如果不在 那这个消息就丢失了 发送方也无法得知是否发送成功 UDP的好处就是简单节省，经济    实例  DatagramSocket:通讯的数据管道  send和receive方法 （可选，多网卡）绑定一个IP和Port   DatagramPacket  集装箱：封装数据 地址标签：目的地IP+Port Receive:    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  package JavaLearning_Advanced.UDP; import java.net.DatagramPacket; import java.net.DatagramSocket; import java.net.SocketException; /** * @Description: receive * @author: Anhlaidh * @date: 2020/3/29 0029 0:23 */ public class UdpRecv { public static void main(String[] args) throws Exception { DatagramSocket socket = new DatagramSocket(3000); byte[] buf = new byte[1024]; DatagramPacket packet = new DatagramPacket(buf,buf.length); System.out.println(\"UdpRecv：等待信息\"); socket.receive(packet); System.out.println(\"UdpRecv:已接受信息\"); String strRecv = new String(packet.getData(), 0, packet.getLength()) + \"from\" + packet.getAddress().getHostAddress() + \":\" + packet.getPort(); System.out.println(strRecv); String str = \"nice to meet you!!\"; DatagramPacket packet1 = new DatagramPacket(str.getBytes(), str.length(), packet.getAddress(), packet.getPort()); System.out.println(\"UdpRecv:即将发送信息！\"); socket.send(packet1); System.out.println(\"UdpRecv:已发送\"); } }   send:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  package JavaLearning_Advanced.UDP; import java.net.DatagramPacket; import java.net.DatagramSocket; import java.net.InetAddress; /** * @Description: send * @author: Anhlaidh * @date: 2020/3/29 0029 0:24 */ public class UdpSend { public static void main(String[] args) throws Exception{ DatagramSocket socket = new DatagramSocket(); String str = \"hi ,im a mini robot\"; DatagramPacket packet = new DatagramPacket(str.getBytes(), str.length(), InetAddress.getByName(\"127.0.0.1\"), 3000); System.out.println(\"UdpSend:我要发送信息了\"); socket.send(packet); System.out.println(\"UdpSend: 发送完毕\"); Thread.sleep(1000); byte[] buf = new byte[1024]; DatagramPacket packet1 = new DatagramPacket(buf, 1024); System.out.println(\"UdpSend：我在等待信息\"); socket.receive(packet1); System.out.println(\"UdpSend：已收到信息\"); String str2 = new String(packet1.getData(), 0, packet1.getLength())+\"from\"+packet1.getAddress().getHostAddress() +\":\"+packet1.getPort(); System.out.println(str2); } }   TCP   TCP协议：有链接、保证可靠的无误差通讯\n 服务器：创建一个ServerSocket，等待连接 客户机：创建一个Socket，连接到服务器 服务器：ServerSocket接收到连接，创建一个Socket和客户的Socket建立专线连接，后续服务器和客户机的对话 （这一对Socket）会在一个单独的线程（服务器端）上运行 服务器的ServerSocket继续等待连接，返回 i.    软件服务器有两要求：\n 它能够实现一定的功能 它必须在一个公开地址上对外提供服务    ServerSocket：服务码头\n 需要绑定Port 如果有多块网卡，需要绑定一个IP地址    Socket：运输通道\n 客户端需要绑定服务器的地址和Port 客户端往Socket输入流写入数据，送到服务端 客户端从Socket输出流取服务端过来的数据 服务器反之亦然    过程：\n 服务端等待响应时，处于阻塞状态 服务端可以同时响应多个客户端 服务端每接受一个客户端，就启动一个独立的线程与其对应 客户端或者服务端都可以选择关闭这条Socket通道 实例  服务端先启动，且一直保留 客户端后启动，可以先退出      Server:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  package JavaLearning_Advanced.TCP; import java.io.*; import java.net.ServerSocket; import java.net.Socket; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 13:16 */ public class TCPServer2 { public static void main(String[] args) { try { ServerSocket serverSocket = new ServerSocket(8001); while (true) { Socket socket = serverSocket.accept(); System.out.println(\"来了一个client\"); new Thread(new Worker(socket)).start(); } } catch (Exception e) { e.printStackTrace(); } } private static class Worker implements Runnable{ private Socket socket; public Worker(Socket socket) { this.socket = socket; } @Override public void run() { try { System.out.println(\"服务人员已启动\"); InputStream inputStream = socket.getInputStream(); OutputStream outputStream = socket.getOutputStream(); DataOutputStream dos = new DataOutputStream(outputStream); BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream)); while (true) { String strWord = bufferedReader.readLine(); System.out.println(\"client said:\" + strWord + \":\" + strWord.length()); if (strWord.equalsIgnoreCase(\"quit\")) { break; } String strEcho = strWord + \"666\"; System.out.println(\"server said:\" + strWord + \"---------\" + strEcho); dos.writeBytes(strWord + \"---------\" +strEcho+ System.getProperty(\"line.separator\")); } bufferedReader.close(); dos.close(); } catch (Exception e) { e.printStackTrace(); } } } }   Client:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42  package JavaLearning_Advanced.TCP; import java.io.*; import java.net.InetAddress; import java.net.Socket; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 11:47 */ public class TcpClient { public static void main(String[] args) { try { Socket socket = new Socket(InetAddress.getByName(\"127.0.0.1\"), 8001); // 同一个通道，服务端输出流就是客户端的输入流，服务端的输入流，就是客户端的输出流  InputStream inputStream = socket.getInputStream();//开启通道的输入流  BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream)); OutputStream outputStream = socket.getOutputStream();//开启通道的输出流  DataOutputStream dataOutputStream = new DataOutputStream(outputStream); BufferedReader brKey = new BufferedReader(new InputStreamReader(System.in)); while (true) { String strWord = brKey.readLine(); if (strWord.equalsIgnoreCase(\"quit\")) { break; } else { System.out.println(\"i want to sent \"+strWord); // outputStream.write(strWord.getBytes(), 0, strWord.length());//可以这么写  dataOutputStream.writeBytes(strWord+System.getProperty(\"line.separator\")); System.out.println(\"server said\"+bufferedReader.readLine()); } } dataOutputStream.close(); bufferedReader.close(); } catch (Exception e) { e.printStackTrace(); } } }   HTTP  在浏览器输入URL地址 浏览器将连接到远程服务器（IP=Port(80)） 请求下载一个HTML文件下来，放到本地临时文件夹中 在浏览器显示出来  实例  URLConnection  获取资源的连接器 根据URL的openConnection()方法获得URLConnection connect方法，建立和资源的联系通道 getInputStream方法，获取资源的内容    get:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  package JavaLearning_Advanced.HTTP; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.net.URL; import java.net.URLConnection; import java.util.List; import java.util.Map; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 14:14 */ public class URLConnectionGet { public static void main(String[] args) { try { String urlName = \"http://www.baidu.com\"; URL url = new URL(urlName); URLConnection connection = url.openConnection(); connection.connect(); //打印Http的头部信息  MapString, ListString headers = connection.getHeaderFields(); for (Map.EntryString, ListString entry : headers.entrySet()) { String key = entry.getKey(); for (String value : entry.getValue()) { System.out.println(key + \":\" + value); } } //输出将要收到的内容属性信息  System.out.println(\"-------------------\"); System.out.println(\"getContentType\" + connection.getContentType()); System.out.println(\"getContentLength\" + connection.getContentLength()); System.out.println(\"getContentEncoding\" + connection.getContentEncoding()); System.out.println(\"getDate\" + connection.getDate()); System.out.println(\"getExpiration\" + connection.getExpiration()); System.out.println(\"getLastModified\" + connection.getLastModified()); System.out.println(\"-------------------\"); BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(connection.getInputStream(),\"UTF-8\")); //输出收到的内容  String line = \"\"; while ((line = bufferedReader.readLine()) != null) { System.out.println(line); } bufferedReader.close(); } catch (IOException e) { e.printStackTrace(); } } }   Post:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  package JavaLearning_Advanced.HTTP; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; import java.io.InputStream; import java.io.PrintWriter; import java.net.*; import java.util.HashMap; import java.util.Map; import java.util.Scanner; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 14:42 */ public class URLConnectionPost { public static void main(String[] args) throws IOException { String url = \"https://www.usps.com/go/ZipLookupAction.action\"; Object userAgent = \"Httpie/0.9.2\"; Object redirects = \"1\"; CookieHandler.setDefault(new CookieManager(null, CookiePolicy.ACCEPT_ALL)); MapString, String params = new HashMapString, String(); params.put(\"tAddress\", \"1 Market Street\"); params.put(\"tCity\", \"San Francisco\"); params.put(\"sState\", \"CA\"); String result = doPost(new URL(url), params, userAgent == null ? null : userAgent.toString(), redirects == null ? -1 : Integer.parseInt(redirects.toString())); System.out.println(result); } private static String doPost(URL url, MapString, String nameValueParis, String userAgent, int redirects) throws IOException { HttpURLConnection connection = (HttpURLConnection) url.openConnection(); if (userAgent != null) { connection.setRequestProperty(\"User-Agent\", userAgent); } if (redirects = 0) { connection.setInstanceFollowRedirects(false); connection.setDoOutput(true); } //输出请求的参数  try (PrintWriter out = new PrintWriter(connection.getOutputStream())) { boolean first = true; for (Map.EntryString, String pair : nameValueParis.entrySet()) { //参数必须这样拼接a=1\u0026b=2\u0026c=3  if (first) { first = false; } else { out.println('\u0026'); } String name = pair.getKey(); String value = pair.getValue(); out.print(name); out.print('='); out.print(URLEncoder.encode(value, \"UTF-8\")); } String encoding = connection.getContentEncoding(); if (encoding == null) { encoding = \"UTF-8\"; } if (redirects  0) { int responseCode = connection.getResponseCode(); System.out.println(\"responseCode:\" + responseCode); if (responseCode == HttpURLConnection.HTTP_MOVED_PERM || responseCode == HttpURLConnection.HTTP_MOVED_TEMP || responseCode == HttpURLConnection.HTTP_SEE_OTHER) { String location = connection.getHeaderField(\"Location\"); if (location != null) { URL base = connection.getURL(); connection.disconnect(); return doPost(new URL(base, location), nameValueParis, userAgent, redirects - 1); } } } else if (redirects == 0) { throw new IOException(\"too many redirects\"); } //获取html内容  StringBuilder response = new StringBuilder(); try (Scanner in = new Scanner(connection.getInputStream(), encoding)) { while (in.hasNextLine()) { response.append(in.nextLine()); response.append(\"\\n\"); } } catch (IOException e) { InputStream err = connection.getErrorStream(); if (err == null) { throw e; } try (Scanner in = new Scanner(err)) { response.append(in.nextLine()); response.append(\"\\n\"); } } return response.toString(); } } }   JDK HttpClient (JDK9新增，JDK10更新，JDK11正式发布)  java.net.http包 取代URLConnection 支持HTTP/1.1和HTTP/2 实现大部分HTTP方法 主要类  HttpClient HttpRequest HttpResponse    Get:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  package JavaLearning_Advanced.HTTP.HttpClient; import java.net.URI; import java.net.http.HttpClient; import java.net.http.HttpRequest; import java.net.http.HttpResponse; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 15:38 */ public class JDKHttpClientGet { public static void main(String[] args) { doGet(); } private static void doGet() { try { HttpClient client = HttpClient.newHttpClient(); HttpRequest request = HttpRequest.newBuilder(URI.create(\"http://www.baidu.com\")).build(); HttpResponse response = client.send(request, HttpResponse.BodyHandlers.ofString()); System.out.println(response.body()); } catch (Exception e) { e.printStackTrace(); } } }   Post:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  package JavaLearning_Advanced.HTTP.HttpClient; import java.net.URI; import java.net.URLEncoder; import java.net.http.HttpClient; import java.net.http.HttpRequest; import java.net.http.HttpResponse; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 15:43 */ public class JDKHttpClientPost { public static void main(String[] args) { doPost(); } private static void doPost() { try { HttpClient client = HttpClient.newBuilder().build(); HttpRequest request = HttpRequest.newBuilder() .uri(URI.create(\"https://zh-tools.usps.com/zip-code-lookup.htm?byaddress\")) .header(\"User-Agent\", \"HTTPie/0.9.2\") .header(\"Content-Type\", \"application/x-www-form-urlencoded;charset=utf-8\") .POST(HttpRequest.BodyPublishers.ofString( \"tAdress=\" + URLEncoder.encode(\"1 Market Street\", \"UTF-8\") + \"tCity=\"+ URLEncoder.encode(\"San Francisco\", \"UTF-8\") + \"sState=\"+ \"CA\") ).build(); HttpResponse response = client.send(request, HttpResponse.BodyHandlers.ofString()); System.out.println(response.statusCode()); System.out.println(response.headers()); System.out.println(response.body().toString()); } catch (Exception e) { e.printStackTrace(); } } }   HttpComponent Get:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  package JavaLearning_Advanced.HTTP.HttpComponet; import org.apache.http.HttpResponse; import org.apache.http.client.config.RequestConfig; import org.apache.http.client.methods.HttpGet; import org.apache.http.impl.client.CloseableHttpClient; import org.apache.http.impl.client.HttpClients; import org.apache.http.util.EntityUtils; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 16:53 */ public class HttpComponentsGet { public static void main(String[] args) { CloseableHttpClient httpClient = HttpClients.createDefault(); RequestConfig requestConfig = RequestConfig.custom() .setConnectionRequestTimeout(5000)//设置超时时间  .setConnectionRequestTimeout(5000)//设置请求超时时间  .setSocketTimeout(5000) .setRedirectsEnabled(true)//默认允许自动重定向  .build(); HttpGet httpGet = new HttpGet(\"http://www.baidu.com\"); httpGet.setConfig(requestConfig); String strResult = \"\"; try { HttpResponse httpResponse = httpClient.execute(httpGet); if (httpResponse.getStatusLine().getStatusCode() == 200) { strResult = EntityUtils.toString(httpResponse.getEntity(),\"UTF-8\");//获得返回结果  System.out.println(strResult); } } catch (Exception e) { e.printStackTrace(); } } }   Post;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  package JavaLearning_Advanced.HTTP.HttpComponet; import org.apache.http.HttpResponse; import org.apache.http.client.config.RequestConfig; import org.apache.http.client.entity.UrlEncodedFormEntity; import org.apache.http.client.methods.HttpPost; import org.apache.http.impl.client.CloseableHttpClient; import org.apache.http.impl.client.HttpClientBuilder; import org.apache.http.impl.client.LaxRedirectStrategy; import org.apache.http.message.BasicNameValuePair; import org.apache.http.util.EntityUtils; import java.io.UnsupportedEncodingException; import java.net.URLEncoder; import java.util.ArrayList; import java.util.List; /** * @Description: * @author: Anhlaidh * @date: 2020/3/29 0029 17:03 */ public class HttpComponentsPost { public static void main(String[] args) throws UnsupportedEncodingException { //获取可关闭的httpClient  //CloseableHttpClient  CloseableHttpClient httpClient = HttpClientBuilder.create().setRedirectStrategy(new LaxRedirectStrategy()).build(); //配置超时时间  RequestConfig requestConfig = RequestConfig.custom() .setSocketTimeout(10000) .setConnectTimeout(10000) .setConnectionRequestTimeout(10000) .setRedirectsEnabled(false).build(); HttpPost httpPost = new HttpPost(\"https://zh-tools.usps.com/zip-code-lookup.htm?byaddress\"); //配置post参数  ListBasicNameValuePair list = new ArrayList(); list.add(new BasicNameValuePair(\"tAdress\", URLEncoder.encode(\"1 Market Street\", \"UTF-8\")));//请求参数  list.add(new BasicNameValuePair(\"tCity\", URLEncoder.encode(\"San Francisco\", \"UTF-8\")));//请求参数  list.add(new BasicNameValuePair(\"sState\", \"CA\"));//请求参数  try { UrlEncodedFormEntity entity = new UrlEncodedFormEntity(list, \"UTF-8\"); // 设置post请求参数  httpPost.setEntity(entity); httpPost.setHeader(\"User-Agent\", \"HTTPie/0.9.2\"); HttpResponse httpResponse = httpClient.execute(httpPost); String result = \"\"; if (httpResponse != null) { int statusCode = httpResponse.getStatusLine().getStatusCode(); System.out.println(statusCode); if (statusCode == 200) { result = EntityUtils.toString(httpResponse.getEntity()); } else { result = \"ERROR Response\" + httpResponse.getStatusLine().toString(); } } else { } System.out.println(result); } catch (Exception e) { e.printStackTrace(); }finally { try { if (httpClient != null) { httpClient.close(); } } catch (Exception e) { e.printStackTrace(); } } } }   Java调用其他语言 Python  解释性脚本语言 目前版本3 Jython  将Python源码编译成JVM字节码,由JVM执行对应的字节码,可以很好的与JVM继承 不是Java与Python的连接器    ",
  "wordCount" : "6461",
  "inLanguage": "zh",
  "image":"http://blog.oxide.ink/%3Cimage%20path/url%3E","datePublished": "2021-06-08T16:59:00+08:00",
  "dateModified": "2021-06-08T16:59:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://blog.oxide.ink/posts/test007/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Oxide",
    "logo": {
      "@type": "ImageObject",
      "url": "http://blog.oxide.ink/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://blog.oxide.ink/" accesskey="h" title="Oxide (Alt + H)">Oxide</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://blog.oxide.ink/en/" title="English"
                            aria-label="English">English</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://blog.oxide.ink/archives" title="文章归档">
                    <span>文章归档</span>
                </a>
            </li>
            <li>
                <a href="http://blog.oxide.ink/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="http://blog.oxide.ink/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://blog.oxide.ink/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="http://blog.oxide.ink/links/" title="友情链接">
                    <span>友情链接</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://blog.oxide.ink/">Home</a>&nbsp;»&nbsp;<a href="http://blog.oxide.ink/posts/">Posts</a></div>
    <h1 class="post-title">
      Java笔记02
    </h1>
    <div class="post-description">
      Desc Text.
    </div>
    <div class="post-meta">June 8, 2021&nbsp;·&nbsp;31 分钟&nbsp;·&nbsp;Me&nbsp;|&nbsp;
<ul class="i18n_list">语言:
    <li>
        <a href="http://blog.oxide.ink/en/posts/test007/">English</a>
    </li>
</ul>&nbsp;|&nbsp;<a href="https://github.com/%3cpath_to_repo%3e/content/posts/test007.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">目录</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#maven" aria-label="Maven">Maven</a></li>
                <li>
                    <a href="#junit" aria-label="Junit">Junit</a><ul>
                        
                <li>
                    <a href="#%e6%b5%8b%e8%af%95" aria-label="测试">测试</a><ul>
                        
                <li>
                    <a href="#junit-1" aria-label="Junit">Junit</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#java%e5%ad%97%e7%ac%a6%e7%bc%96%e7%a0%81" aria-label="Java字符编码">Java字符编码</a></li>
                <li>
                    <a href="#%e5%9b%bd%e9%99%85%e5%8c%96" aria-label="国际化">国际化</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%ba%a7%e5%ad%97%e7%ac%a6%e7%bc%96%e7%a0%81" aria-label="高级字符编码">高级字符编码</a><ul>
                        
                <li>
                    <a href="#%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f" aria-label="正则表达式">正则表达式</a></li></ul>
                </li>
                <li>
                    <a href="#xml" aria-label="xml">xml</a><ul>
                        
                <li>
                    <a href="#xml%e8%a7%a3%e6%9e%90" aria-label="xml解析">xml解析</a></li></ul>
                </li>
                <li>
                    <a href="#json" aria-label="JSON">JSON</a></li>
                <li>
                    <a href="#%e5%9b%be%e7%89%87" aria-label="图片">图片</a></li>
                <li>
                    <a href="#%e5%a4%9a%e8%bf%9b%e7%a8%8b%e5%92%8c%e5%a4%9a%e7%ba%bf%e7%a8%8b" aria-label="多进程和多线程">多进程和多线程</a><ul>
                        
                <li>
                    <a href="#%e6%a6%82%e5%bf%b5" aria-label="概念">概念</a><ul>
                        
                <li>
                    <a href="#%e5%a4%9a%e8%bf%9b%e7%a8%8b" aria-label="多进程">多进程</a></li>
                <li>
                    <a href="#%e5%a4%9a%e7%ba%bf%e7%a8%8b" aria-label="多线程">多线程</a><ul>
                        
                <li>
                    <a href="#%e5%90%af%e5%8a%a8" aria-label="启动">启动</a></li>
                <li>
                    <a href="#%e8%a7%84%e5%88%99" aria-label="规则">规则</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%a4%9a%e8%bf%9b%e7%a8%8b%e5%92%8c%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%9a%84%e5%af%b9%e6%af%94" aria-label="多进程和多线程的对比">多进程和多线程的对比</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%a4%9a%e7%ba%bf%e7%a8%8b%e4%bf%a1%e6%81%af%e5%85%b1%e4%ba%ab" aria-label="多线程信息共享">多线程信息共享</a></li>
                <li>
                    <a href="#%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%ae%a1%e7%90%86" aria-label="多线程管理">多线程管理</a></li>
                <li>
                    <a href="#%e5%b9%b6%e5%8f%91%e6%a1%86%e6%9e%b6" aria-label="并发框架">并发框架</a></li>
                <li>
                    <a href="#%e5%b9%b6%e8%a1%8c%e8%ae%a1%e7%ae%97" aria-label="并行计算">并行计算</a></li>
                <li>
                    <a href="#%e7%ba%bf%e7%a8%8b%e7%bb%84%e7%ae%a1%e7%90%86" aria-label="线程组管理">线程组管理</a></li>
                <li>
                    <a href="#executor" aria-label="Executor*">Executor*</a></li>
                <li>
                    <a href="#fork-join" aria-label="Fork-Join">Fork-Join</a><ul>
                        
                <li>
                    <a href="#%e4%b8%bb%e8%a6%81%e7%b1%bb" aria-label="主要类">主要类</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b9%b6%e5%8f%91%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="并发数据结构">并发数据结构</a></li>
                <li>
                    <a href="#%e5%b9%b6%e5%8f%91%e5%8d%8f%e4%bd%9c%e4%b8%8e%e6%8e%a7%e5%88%b6" aria-label="并发协作与控制">并发协作与控制</a><ul>
                        
                <li>
                    <a href="#lock" aria-label="Lock">Lock</a></li>
                <li>
                    <a href="#semaphore" aria-label="Semaphore">Semaphore</a></li>
                <li>
                    <a href="#latch" aria-label="latch">latch</a></li>
                <li>
                    <a href="#barrier" aria-label="Barrier">Barrier</a></li>
                <li>
                    <a href="#phaser" aria-label="Phaser">Phaser</a></li>
                <li>
                    <a href="#exchanger" aria-label="Exchanger">Exchanger</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1" aria-label="定时任务">定时任务</a></li></ul>
                </li>
                <li>
                    <a href="#java%e7%bd%91%e7%bb%9c%e7%bc%96%e7%a8%8b" aria-label="Java网络编程">Java网络编程</a><ul>
                        
                <li>
                    <a href="#%e7%bd%91%e7%bb%9c%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86" aria-label="网络基础知识">网络基础知识</a></li>
                <li>
                    <a href="#udp" aria-label="UDP">UDP</a><ul>
                        
                <li>
                    <a href="#%e5%ae%9e%e4%be%8b" aria-label="实例">实例</a></li></ul>
                </li>
                <li>
                    <a href="#tcp" aria-label="TCP">TCP</a></li>
                <li>
                    <a href="#http" aria-label="HTTP">HTTP</a><ul>
                        
                <li>
                    <a href="#%e5%ae%9e%e4%be%8b-1" aria-label="实例">实例</a></li></ul>
                </li>
                <li>
                    <a href="#jdk-httpclient-jdk9%e6%96%b0%e5%a2%9ejdk10%e6%9b%b4%e6%96%b0jdk11%e6%ad%a3%e5%bc%8f%e5%8f%91%e5%b8%83" aria-label="JDK HttpClient (JDK9新增，JDK10更新，JDK11正式发布)">JDK HttpClient (JDK9新增，JDK10更新，JDK11正式发布)</a></li>
                <li>
                    <a href="#httpcomponent" aria-label="HttpComponent">HttpComponent</a></li></ul>
                </li>
                <li>
                    <a href="#java%e8%b0%83%e7%94%a8%e5%85%b6%e4%bb%96%e8%af%ad%e8%a8%80" aria-label="Java调用其他语言">Java调用其他语言</a><ul>
                        
                <li>
                    <a href="#python" aria-label="Python">Python</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="maven">Maven<a hidden class="anchor" aria-hidden="true" href="#maven">#</a></h2>
<h2 id="junit">Junit<a hidden class="anchor" aria-hidden="true" href="#junit">#</a></h2>
<h3 id="测试">测试<a hidden class="anchor" aria-hidden="true" href="#测试">#</a></h3>
<ul>
<li>
<p>单元测试：对软件中最小可测试单元进行检查和验证，通常是一个函数/方法（属于白盒测试）</p>
<ul>
<li>集成测试： 将多个单元相互作用，形成一个整体，对整体协调性进行测试</li>
</ul>
</li>
<li>
<p>白盒测试： 全面了解程序内部逻辑结构，对所有的逻辑路径都进行测试，一般由程序员完成</p>
<ul>
<li>黑盒测试：又名功能测试，将程序看作不可打开的盒子，一般由独立使用者完成</li>
</ul>
</li>
<li>
<p>自动测试：用程序批量、反复的测试程序，并可自动检查程序结果是否满足预定的要求</p>
<ul>
<li>手动测试：手动执行程序，手动输入所需要的参数，手动检查程序结果是否满足预定的要求</li>
</ul>
</li>
<li>
<p>回归测试：修改旧代码后，重新进行测试以确认修改没有引入新的错误或导致其他代码产生错误</p>
</li>
<li>
<p>深入学习：软件测试-基于问题驱动模式 朱少民</p>
</li>
</ul>
<h4 id="junit-1">Junit<a hidden class="anchor" aria-hidden="true" href="#junit-1">#</a></h4>
<ul>
<li>
<p>import static     导入该包内的所有静态方法，使用时可不加类名</p>
</li>
<li>
<p>Triangle</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.Maven</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 13:42
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Triangle</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">judgeEdges</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="c1">//边长非负性
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">0</span> <span class="o">||</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="n">0</span> <span class="o">||</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">//两边和大于第三边
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">&lt;=</span><span class="n">c</span><span class="o">)</span> <span class="o">{</span>
<span class="k">return</span> <span class="kc">false</span><span class="o">;}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">&lt;=</span><span class="n">a</span><span class="o">)</span> <span class="o">{</span>
<span class="k">return</span> <span class="kc">false</span><span class="o">;}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">+</span><span class="n">a</span><span class="o">&lt;=</span><span class="n">b</span><span class="o">)</span> <span class="o">{</span>
<span class="k">return</span> <span class="kc">false</span><span class="o">;}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>testTriangle</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">JavaLearning_Advanced.Maven.Triangle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 13:44
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">testTriangle</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span><span class="k">new</span> <span class="n">Triangle</span><span class="o">().</span><span class="na">judgeEdges</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">2</span><span class="o">,</span><span class="n">3</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>深入学习：Junit实战（第二版），PetarTahchiey</li>
</ul>
<h2 id="java字符编码">Java字符编码<a hidden class="anchor" aria-hidden="true" href="#java字符编码">#</a></h2>
<ul>
<li>尽可能使用UTF-8</li>
<li>读取写入编码保持一致</li>
</ul>
<h2 id="国际化">国际化<a hidden class="anchor" aria-hidden="true" href="#国际化">#</a></h2>
<ul>
<li>
<p>Locale 方法</p>
<ul>
<li>getAvailableLocales()获取所有可用的locale</li>
<li>getDefault()返回默认的Locale</li>
</ul>
</li>
<li>
<p>native2ascii.exe</p>
</li>
<li>
<p>ResourceBundle</p>
<ul>
<li>根据Locale要求，加载语言文件</li>
<li>存储语言集合中的K-V对</li>
<li>getString(String key) 返回对应的value</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.International</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Locale</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ResourceBundle</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 14:34
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//取得系统默认的国家/语言环境
</span><span class="c1"></span>        <span class="n">Locale</span> <span class="n">myLocale</span> <span class="o">=</span> <span class="n">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">myLocale</span><span class="o">);</span><span class="c1">//zh_CN
</span><span class="c1"></span>        <span class="c1">//根据指定语言，国家环境，加载资源文件
</span><span class="c1"></span>        <span class="n">ResourceBundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">ResourceBundle</span><span class="o">.</span><span class="na">getBundle</span><span class="o">(</span><span class="s">&#34;message&#34;</span><span class="o">,</span> <span class="n">myLocale</span><span class="o">);</span>
        <span class="c1">//从资源文件中获取信息
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">bundle</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;hello&#34;</span><span class="o">));</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="高级字符编码">高级字符编码<a hidden class="anchor" aria-hidden="true" href="#高级字符编码">#</a></h2>
<h3 id="正则表达式">正则表达式<a hidden class="anchor" aria-hidden="true" href="#正则表达式">#</a></h3>
<ul>
<li>
<p>学习正则表达式：
精通正则表达式（第三版） Jefferry E.F.Friedl</p>
</li>
<li>
<p>java.util.regex包</p>
<ul>
<li>Pattern 正则表达式的编译表示
<ul>
<li>compile编译一个正则表达式喂Pattern对象</li>
<li>matcher用Pattern对象匹配一个字符串，返回匹配结果</li>
</ul>
</li>
<li>Matcher
<ul>
<li>IndexMethod(位置方法) //start(),start(int group),end(),end(group)</li>
<li>StudyMethod(查找方法) //lookingAt(),find(),find(int start),matches()</li>
<li>Replacement(替换方法) //replaceAll(String replacement)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Matcher</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.regex</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.regex.Matcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 19:21
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MatcherDemo</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">REGEX</span> <span class="o">=</span> <span class="s">&#34;\\bdog\\b&#34;</span><span class="o">;</span><span class="c1">//\b表示边界
</span><span class="c1"></span>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="s">&#34;dog dog dog doggie dogg&#34;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//检查字符串里有多少个dog
</span><span class="c1"></span>        <span class="n">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">REGEX</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">INPUT</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">count</span><span class="o">++;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Match number&#34;</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;start()&#34;</span> <span class="o">+</span> <span class="n">matcher</span><span class="o">.</span><span class="na">start</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;end()&#34;</span> <span class="o">+</span> <span class="n">matcher</span><span class="o">.</span><span class="na">end</span><span class="o">());</span>
<span class="c1">//        String f = &#34;fooooooooooooo&#34;;
</span><span class="c1">//        matcher.lookingAt();//不完全匹配,匹配foo为true
</span><span class="c1">//        matcher.find();//完全匹配，匹配foo为false
</span><span class="c1"></span>        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Replace</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.regex</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.regex.Matcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 19:39
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReplaceDemo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">Replace_1</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">REGEX</span> <span class="o">=</span> <span class="s">&#34;a*b&#34;</span><span class="o">;</span><span class="c1">//*表示限定前面的a可以有0个或者多个
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="s">&#34;aavfooabfooabafoobcdd&#34;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">REPLACE</span> <span class="o">=</span> <span class="s">&#34;-&#34;</span><span class="o">;</span>
        <span class="n">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">REGEX</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">INPUT</span><span class="o">);</span>
        <span class="n">StringBuffer</span> <span class="n">stringBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
        <span class="c1">// 全部替换
</span><span class="c1"></span>        <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">matcher</span><span class="o">.</span><span class="na">appendReplacement</span><span class="o">(</span><span class="n">stringBuffer</span><span class="o">,</span> <span class="n">REPLACE</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//最后将尾巴字符串附加上
</span><span class="c1"></span>        <span class="n">matcher</span><span class="o">.</span><span class="na">appendTail</span><span class="o">(</span><span class="n">stringBuffer</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringBuffer</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">Replace_2</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">REGEX</span> <span class="o">=</span> <span class="s">&#34;dog&#34;</span><span class="o">;</span><span class="c1">//*表示限定前面的a可以有0个或者多个
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="s">&#34;The dog says meow.All dogs say meow&#34;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">REPLACE</span> <span class="o">=</span> <span class="s">&#34;cat&#34;</span><span class="o">;</span>
        <span class="n">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">REGEX</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">INPUT</span><span class="o">);</span>
        <span class="n">INPUT</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="n">REPLACE</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">INPUT</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>OJ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.regex</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.io.Charsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.io.IOUtils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.LinkedList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/23 0023 19:55
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">String2inputStream</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//构造字符串列表
</span><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;&gt;();</span>
        <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;xiaohong&#34;</span><span class="o">);</span>
        <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;xiaoming&#34;</span><span class="o">);</span>
        <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Daming&#34;</span><span class="o">);</span>
        <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;xiaohei&#34;</span><span class="o">);</span>
        <span class="c1">//合并为一个字符串，以逗号相连
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">nameStr</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">,</span> <span class="n">names</span><span class="o">);</span>
        <span class="c1">//将字符串作为默认输入流
</span><span class="c1"></span>        <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">IOUtils</span><span class="o">.</span><span class="na">toInputStream</span><span class="o">(</span><span class="n">nameStr</span><span class="o">,</span> <span class="n">Charsets</span><span class="o">.</span><span class="na">toCharset</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">));</span>
        <span class="c1">//重置系统的输入流
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">setIn</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
        <span class="c1">//模拟键盘输入，这也是OJ平台测试用例输入的原理
</span><span class="c1"></span>        <span class="c1">//此处也可以换成一个文件的输入流
</span><span class="c1"></span>        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="n">scanner</span><span class="o">.</span><span class="na">useDelimiter</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="xml">xml<a hidden class="anchor" aria-hidden="true" href="#xml">#</a></h2>
<ul>
<li>常规语法
<ul>
<li>任何的起始标签都必须有一个结束标签</li>
<li>简化写法，例如，<!-- raw HTML omitted --><!-- raw HTML omitted -->可以写为<!-- raw HTML omitted --></li>
<li>大小写敏感，name和Name不一样</li>
<li>每个文件都要有一个根元素</li>
<li>标签必须按合适的顺序进行嵌套，不可错位</li>
<li>所有的特性都必须有值，且在值的周围加上引号</li>
<li>需要转义字符，如&quot;&lt;&ldquo;需要用&lt;代替
<ul>
<li>
<table>
<thead>
<tr>
<th>转义</th>
<th>符号</th>
<th>意思</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;lt;</td>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&amp;gt;</td>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&amp;amp;</td>
<td>&amp;</td>
<td>和号</td>
</tr>
<tr>
<td>&amp;apos;</td>
<td>'</td>
<td>单引号</td>
</tr>
<tr>
<td>&amp;quot;</td>
<td>&quot;</td>
<td>双引号</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>注释：&lt;!&ndash;  内容  &ndash;&gt;</li>
</ul>
</li>
</ul>
<h3 id="xml解析">xml解析<a hidden class="anchor" aria-hidden="true" href="#xml解析">#</a></h3>
<p>未完成</p>
<h2 id="json">JSON<a hidden class="anchor" aria-hidden="true" href="#json">#</a></h2>
<ul>
<li>概念
<ul>
<li>JavaScript Object Notation ，JS对象表示法</li>
<li>是一种轻量级的数据交换格式</li>
<li>类似XML，更小、更快、更易解析</li>
<li>最早用于JavaScript中，容易解析，最后推广到全语言</li>
<li>尽管使用JavaScript语法，但是独立于编程语言</li>
</ul>
</li>
<li>用途
<ul>
<li>JSON生成</li>
<li>JSON解析</li>
<li>JSON校验</li>
<li>和JavaBean对象进行互解析
<ul>
<li>具有一个无参的构造函数</li>
<li>可以包括多个属性，所有属性都是private</li>
<li>每个属性都有对应的Getter/Setter方法</li>
<li>JavaBean 用于封装数据，有可称为POJO(Plain Old notes.Java Object)</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.Json</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.core.type.TypeReference</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.JsonNode</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/26 0026 21:42
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">testJackson</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">testJsonObject</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;分割线=====================================================&#34;</span><span class="o">);</span>
        <span class="n">testJsonFile</span><span class="o">();</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testJsonFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
        <span class="c1">//从json文件中加载，并重构为java对象
</span><span class="c1"></span>        <span class="n">File</span> <span class="n">json</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;temp/json/books.json&#34;</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="n">books</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="k">new</span> <span class="n">TypeReference</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
        <span class="o">});</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Book</span> <span class="n">book</span> <span class="o">:</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">.</span><span class="na">getAuthor</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testJsonObject</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
        <span class="c1">//构造对象
</span><span class="c1"></span>        <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="o">();</span>
        <span class="n">person</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;TOM&#34;</span><span class="o">);</span>
        <span class="n">person</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">20</span><span class="o">);</span>
        <span class="n">person</span><span class="o">.</span><span class="na">setScores</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">60</span><span class="o">,</span> <span class="n">70</span><span class="o">,</span> <span class="n">80</span><span class="o">));</span>
        <span class="c1">//将对象解析为json字符串
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">jsonStr</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">person</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonStr</span><span class="o">);</span>
        <span class="c1">//json字符串重构对象
</span><span class="c1"></span>        <span class="n">Person</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">jsonStr</span><span class="o">,</span> <span class="n">Person</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p2</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p2</span><span class="o">.</span><span class="na">getAge</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p2</span><span class="o">.</span><span class="na">getScores</span><span class="o">());</span>
        <span class="c1">//从json字符串重构JsonNode对象
</span><span class="c1"></span>        <span class="n">JsonNode</span> <span class="n">node</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">readTree</span><span class="o">(</span><span class="n">jsonStr</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">).</span><span class="na">asText</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">).</span><span class="na">asText</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;scores&#34;</span><span class="o">));</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">&#34;category&#34;</span><span class="p">:</span> <span class="s2">&#34;COOKING&#34;</span><span class="p">,</span>
    <span class="nt">&#34;tools.title&#34;</span><span class="p">:</span> <span class="s2">&#34;Everyday Italian&#34;</span><span class="p">,</span>
    <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;Giada De Laurentiis&#34;</span><span class="p">,</span>
    <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="s2">&#34;2005&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">30</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;category&#34;</span><span class="p">:</span> <span class="s2">&#34;CHILDREN&#34;</span><span class="p">,</span>
    <span class="nt">&#34;tools.title&#34;</span><span class="p">:</span> <span class="s2">&#34;Harry Potter&#34;</span><span class="p">,</span>
    <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;J K Rowling&#34;</span><span class="p">,</span>
    <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="s2">&#34;2005&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">29</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;category&#34;</span><span class="p">:</span> <span class="s2">&#34;WEB&#34;</span><span class="p">,</span>
    <span class="nt">&#34;tools.title&#34;</span><span class="p">:</span> <span class="s2">&#34;Learning XML&#34;</span><span class="p">,</span>
    <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;Erik T.Ray&#34;</span><span class="p">,</span>
    <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="s2">&#34;2003&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">39</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>总结
<ul>
<li>JSON是一种独立于编程语言的、轻量的、数据交换格式</li>
<li>有多种第三方库辅助我们进行JSON生成和解析</li>
<li>JSON会丢失顺序性</li>
</ul>
</li>
</ul>
<h2 id="图片">图片<a hidden class="anchor" aria-hidden="true" href="#图片">#</a></h2>
<pre><code>- imageIO
- 验证码
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.picture</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.imageio.ImageIO</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.image.BufferedImage</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/28 0028 19:56
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ValidateCode</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">codeSequence</span><span class="o">=</span> <span class="o">{</span><span class="sc">&#39;A&#39;</span><span class="o">,</span><span class="sc">&#39;B&#39;</span><span class="o">,</span><span class="sc">&#39;C&#39;</span><span class="o">,</span><span class="sc">&#39;D&#39;</span><span class="o">,</span><span class="sc">&#39;E&#39;</span><span class="o">,</span><span class="sc">&#39;F&#39;</span><span class="o">,</span><span class="sc">&#39;G&#39;</span><span class="o">,</span><span class="sc">&#39;H&#39;</span><span class="o">,</span><span class="sc">&#39;I&#39;</span><span class="o">,</span><span class="sc">&#39;J&#39;</span><span class="o">,</span><span class="sc">&#39;K&#39;</span><span class="o">,</span><span class="sc">&#39;L&#39;</span><span class="o">,</span><span class="sc">&#39;M&#39;</span><span class="o">,</span><span class="sc">&#39;N&#39;</span><span class="o">,</span><span class="sc">&#39;O&#39;</span><span class="o">,</span><span class="sc">&#39;P&#39;</span><span class="o">,</span><span class="sc">&#39;Q&#39;</span><span class="o">,</span><span class="sc">&#39;R&#39;</span><span class="o">,</span><span class="sc">&#39;S&#39;</span><span class="o">,</span><span class="sc">&#39;T&#39;</span><span class="o">,</span><span class="sc">&#39;U&#39;</span><span class="o">,</span><span class="sc">&#39;V&#39;</span><span class="o">,</span><span class="sc">&#39;W&#39;</span><span class="o">,</span><span class="sc">&#39;X&#39;</span><span class="o">,</span><span class="sc">&#39;Y&#39;</span><span class="o">,</span><span class="sc">&#39;Z&#39;</span><span class="o">,</span><span class="sc">&#39;2&#39;</span><span class="o">,</span><span class="sc">&#39;3&#39;</span><span class="o">,</span><span class="sc">&#39;4&#39;</span><span class="o">,</span><span class="sc">&#39;5&#39;</span><span class="o">,</span><span class="sc">&#39;6&#39;</span><span class="o">,</span><span class="sc">&#39;7&#39;</span><span class="o">,</span><span class="sc">&#39;8&#39;</span><span class="o">,</span><span class="sc">&#39;9&#39;</span><span class="o">};</span>
    <span class="kd">static</span> <span class="kt">int</span> <span class="n">charNum</span> <span class="o">=</span> <span class="n">codeSequence</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">generateCode</span><span class="o">(</span><span class="s">&#34;./temp/validateCode/code.jpg&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">generateCode</span><span class="o">(</span><span class="n">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">//首先定义验证码图片库
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">140</span><span class="o">;</span><span class="c1">//验证码图片的宽度
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">40</span><span class="o">;</span><span class="c1">//验证码图片的高度
</span><span class="c1"></span>        <span class="n">BufferedImage</span> <span class="n">bufferedImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedImage</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">,</span> <span class="n">BufferedImage</span><span class="o">.</span><span class="na">TYPE_INT_RGB</span><span class="o">);</span>
        <span class="c1">//定义图片上的图形和干扰线
</span><span class="c1"></span>        <span class="n">Graphics2D</span> <span class="n">graphics2D</span> <span class="o">=</span> <span class="n">bufferedImage</span><span class="o">.</span><span class="na">createGraphics</span><span class="o">();</span>
        <span class="n">graphics2D</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">GRAY</span><span class="o">);</span><span class="c1">//将图像填充为浅灰色
</span><span class="c1"></span>        <span class="n">graphics2D</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">);</span>
        <span class="n">graphics2D</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span><span class="c1">//画边框
</span><span class="c1"></span>        <span class="n">graphics2D</span><span class="o">.</span><span class="na">drawRect</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">width</span> <span class="o">-</span> <span class="n">1</span><span class="o">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">1</span><span class="o">);</span>
        <span class="c1">//随机产生16条灰色干扰线
</span><span class="c1"></span>        <span class="n">graphics2D</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">darkGray</span><span class="o">);</span>
        <span class="c1">//创建一个随机数生成器类，用于随机产生干扰线
</span><span class="c1"></span>        <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">16</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">width</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">height</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">50</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">50</span><span class="o">);</span>
            <span class="n">graphics2D</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">);</span>

        <span class="o">}</span>
        <span class="c1">//计算字的位置坐标
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">codeCount</span> <span class="o">=</span> <span class="n">4</span><span class="o">;</span><span class="c1">//字的个数
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">fontHeight</span> <span class="o">;</span><span class="c1">//字体高度
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">codeX</span><span class="o">;</span><span class="c1">//第一个字符的x坐标，因为后面的字符坐标依次递增，所以他们的x轴值是codeX+i的值
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">codeY</span><span class="o">;</span><span class="c1">//验证字符的y坐标，因为并排所以值一样
</span><span class="c1"></span>        <span class="c1">//width-4除去左右多余的位置，使验证码更加集中显示，减的越多越集中
</span><span class="c1"></span>        <span class="c1">//codeCount+1//等比分配显示的宽度，包括左右两边的空格
</span><span class="c1"></span>        <span class="n">codeX</span> <span class="o">=</span> <span class="o">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">4</span><span class="o">)</span> <span class="o">/</span> <span class="o">(</span><span class="n">codeCount</span> <span class="o">+</span> <span class="n">1</span><span class="o">);</span><span class="c1">//第一个字母的起始位置
</span><span class="c1"></span>        <span class="n">fontHeight</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">10</span><span class="o">;</span><span class="c1">//height-10高度中间区域显示验证码
</span><span class="c1"></span>        <span class="n">codeY</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">7</span><span class="o">;</span>
        <span class="c1">//创建字体，字体的大小应该根据图片的高度来定
</span><span class="c1"></span>        <span class="n">Font</span> <span class="n">font</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Font</span><span class="o">(</span><span class="s">&#34;Fixedsys&#34;</span><span class="o">,</span> <span class="n">Font</span><span class="o">.</span><span class="na">PLAIN</span><span class="o">,</span> <span class="n">fontHeight</span><span class="o">);</span>
        <span class="n">graphics2D</span><span class="o">.</span><span class="na">setFont</span><span class="o">(</span><span class="n">font</span><span class="o">);</span>
        <span class="c1">//随机产生codeCount数字的验证码
</span><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">codeCount</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="c1">//每次随机拿一个字母，赋予随机的颜色
</span><span class="c1"></span>            <span class="n">String</span> <span class="n">strRand</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">codeSequence</span><span class="o">[</span><span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">charNum</span><span class="o">)]);</span>
            <span class="kt">int</span> <span class="n">red</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">255</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">blue</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">255</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">green</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">255</span><span class="o">);</span>
            <span class="n">graphics2D</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">));</span>
            <span class="c1">//把字放到图片上
</span><span class="c1"></span>            <span class="n">graphics2D</span><span class="o">.</span><span class="na">drawString</span><span class="o">(</span><span class="n">strRand</span><span class="o">,</span> <span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">)</span> <span class="o">*</span> <span class="n">codeX</span><span class="o">,</span> <span class="n">codeY</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">ImageIO</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bufferedImage</span><span class="o">,</span> <span class="s">&#34;jpg&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">));</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="多进程和多线程">多进程和多线程<a hidden class="anchor" aria-hidden="true" href="#多进程和多线程">#</a></h2>
<h3 id="概念">概念<a hidden class="anchor" aria-hidden="true" href="#概念">#</a></h3>
<h4 id="多进程">多进程<a hidden class="anchor" aria-hidden="true" href="#多进程">#</a></h4>
<ul>
<li>当前的操作系统都是多任务OS</li>
<li>每个独立执行的任务就是一个进程</li>
<li>OS将时间划分为多个时间片（时间很短）</li>
<li>每个时间片内将CPU分配给某一个任务，时间片结束，CPU自动回收，再分配给另外任务。从外部看，所有任务都是同时在执行。
但是在CPU上，任务是按照串行依次运行（单核CPU ）。如果多核，多个进程任务可以并行。但是单个核上，多进程只能串行执行</li>
<li>多进程的优点
<ul>
<li>可以同时运行多个任务</li>
<li>程序因IO堵塞时，可以释放CPU，让CPU为其他程序服务</li>
<li>当系统有多个CPU时，可以为多个程序同时服务
<ul>
<li>我们的CPU不再提高频率，而是提高核数</li>
<li>多核和并行程序才是提高程序性能的唯一办法</li>
</ul>
</li>
</ul>
</li>
<li>多进程的缺点
<ul>
<li>太笨重，不好管理</li>
<li>太笨重，不好切换</li>
</ul>
</li>
</ul>
<h4 id="多线程">多线程<a hidden class="anchor" aria-hidden="true" href="#多线程">#</a></h4>
<ul>
<li>一个程序可以包括多个子任务，可串/并行</li>
<li>每个子任务可以称为一个线程</li>
<li>如果一个子任务阻塞，程序可以将CPU调度另外一个子任务进行工作，这样CPU还是保留在本程序中，而不是被调度到别的程序（进程）去，
这样，提高本程序获得CPU时间和利用率</li>
</ul>
<h5 id="启动">启动<a hidden class="anchor" aria-hidden="true" href="#启动">#</a></h5>
<ul>
<li>start方法，会自动以新进程调用run方法</li>
<li>直接调用run方法，会编程串行执行</li>
<li>同一个线程，多次start会报错，只执行第一次start方法</li>
<li>多个线程启动，其启动的先后顺序是随机的</li>
<li>线程无需关闭，只要其run方法执行结束后，自动关闭</li>
<li>main函数（线程）可能早于新线程结束，整个程序并不终止</li>
<li>整个程序终止是等所有的线程都终止（包括main函数线程）</li>
</ul>
<p>####多线程实现的对比</p>
<ul>
<li>Thread占据了父类名额，不如Runnable方便</li>
<li>Thread类实现Runnable</li>
<li>Runnable启动时需要Thread类的支持</li>
<li>Runnable更容易实现多线程中资源共享</li>
</ul>
<p>结论：建议实现Runnable接口来完成多线程</p>
<h5 id="规则">规则<a hidden class="anchor" aria-hidden="true" href="#规则">#</a></h5>
<p>规则一：
1.调用run方法来启动run方法，将会是串行运行
2. 调用start方法，来启动run方法，将会是并行运行（多线程运行）
规则二：</p>
<ol>
<li>main线程可能早于子线程结束</li>
<li>main线程和子线程都结束了，整个程序才算终止
规则三：
1.实现Runnable的对象必须包装在Thread类里面，才可以启</li>
<li>不能直接对Runnable对象进行start方法
规则四：</li>
<li>一个线程对象不能多次start，多次start将报异常</li>
<li>多个线程对象都start后，哪一个先执行，完全由JVM/操作系统来主导，程序员无法指定</li>
</ol>
<p>一：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.rules</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> *  规则一：
</span><span class="cm"> *  1.调用run方法来启动run方法，将会是串行运行
</span><span class="cm"> *  2. 调用start方法，来启动run方法，将会是并行运行（多线程运行）
</span><span class="cm"> *
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/28 0028 22:59
</span><span class="cm"> */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">first</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="k">new</span> <span class="n">TestThread0</span><span class="o">().</span><span class="na">run</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main&#34;</span><span class="o">);</span>
            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestThread0</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;testThread0&#34;</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>二：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.rules</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * 规则二：
</span><span class="cm"> * 1. main线程可能早于子线程结束
</span><span class="cm"> * 2. main线程和子线程都结束了，整个程序才算终止
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/28 0028 23:06
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">second</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="k">new</span> <span class="n">TestThread1</span><span class="o">().</span><span class="na">start</span><span class="o">();</span>
<span class="c1">//        while (true) {
</span><span class="c1">//            System.out.println(&#34;main&#34;);
</span><span class="c1">//            Thread.sleep(10);
</span><span class="c1">//        }
</span><span class="c1"></span>    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestThread1</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;testThread1&#34;</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>三:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.rules</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * 规则三：
</span><span class="cm"> * 1.实现Runnable的对象必须包装在Thread类里面，才可以启动
</span><span class="cm"> * 2. 不能直接对Runnable对象进行start方法
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/28 0028 23:33
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">third</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
<span class="c1">//        new TestThread2().start();
</span><span class="c1"></span>        <span class="c1">//runnable对象必须放在一个Thread类中才能运行
</span><span class="c1"></span>        <span class="n">TestThread2</span> <span class="n">tt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestThread2</span><span class="o">();</span>
        <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">tt</span><span class="o">);</span>
        <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main&#34;</span><span class="o">);</span>
            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
<span class="c1">//        }
</span><span class="c1"></span>        <span class="o">}</span>

    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestThread2</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
            <span class="c1">//输出当前线程名
</span><span class="c1"></span>            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>四：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.rules</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * 规则四：
</span><span class="cm"> * 1. 一个线程对象不能多次start，多次start将报异常
</span><span class="cm"> * 2. 多个线程对象都start后，哪一个先执行，完全由JVM/操作系统来主导，程序员无法指定
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/28 0028 23:39
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fourth</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestThread4</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestThread4</span><span class="o">();</span>
        <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
<span class="c1">//        t1.start();
</span><span class="c1"></span>        <span class="n">TestThread4</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestThread4</span><span class="o">();</span>
        <span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestThread4</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;is running&#34;</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="多进程和多线程的对比">多进程和多线程的对比<a hidden class="anchor" aria-hidden="true" href="#多进程和多线程的对比">#</a></h4>
<ul>
<li>线程共享数据</li>
<li>线程通讯更高效</li>
<li>线程更轻量级，更容易切换</li>
<li>多个线程更容易管理</li>
</ul>
<h3 id="多线程信息共享">多线程信息共享<a hidden class="anchor" aria-hidden="true" href="#多线程信息共享">#</a></h3>
<ul>
<li>线程类
<ul>
<li>通过继承Thread或实现Runnable</li>
<li>通过start方法，调用run方法，run方法工作</li>
<li>线程run结束后，线程退出</li>
</ul>
</li>
<li>粗粒度：子线程与子线程之间、和main线程之间缺乏交流</li>
<li>细粒度：线程之间有信息交流通讯
<ul>
<li>通过共享变量达到信息共享</li>
<li>Jdk原生库不支持发送消息</li>
</ul>
</li>
<li>通过共享变量在多个线程中共享消息
<ul>
<li>static变量</li>
<li>同一个Runnable类的成员变量</li>
</ul>
</li>
</ul>
<p>test1:继承thread，static修饰的变量可以共享，但是会造成数据重复</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.message</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 20:23
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadDemo0</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="n">TestThread0</span><span class="o">().</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">TestThread0</span><span class="o">().</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">TestThread0</span><span class="o">().</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">TestThread0</span><span class="o">().</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestThread0</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
<span class="c1">//        private int tickets = 100; 每个线程卖100张，没有共享
</span><span class="c1"></span>        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">tickets</span> <span class="o">=</span> <span class="n">100</span><span class="o">;</span>  <span class="c1">//static变量是共享的，所有的线程共享
</span><span class="c1"></span>        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">tickets</span><span class="o">&gt;</span><span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; is selling tickets&#34;</span> <span class="o">+</span> <span class="n">tickets</span><span class="o">);</span>
                <span class="n">tickets</span> <span class="o">=</span> <span class="n">tickets</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>

            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>多线程信息共享问题
<ul>
<li>工作缓存副本</li>
<li>关键步骤缺乏加锁限制</li>
</ul>
</li>
<li>i++，并非原子性操作
<ul>
<li>读取主存i（正本）到工作缓存（副本）中</li>
<li>每个CPU执行（副本）i+1操作</li>
<li>CPU将结果写入到缓存（副本）中</li>
<li>数据从工作缓存（副本）刷到主存（正本）中</li>
</ul>
</li>
<li>变量副本问题的解决办法
<ul>
<li>采用volatile关键字修饰变量</li>
<li>保证不同线程对共享变量操作时的可见性</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.message</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 20:55
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadDemo2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">TestTread3</span> <span class="n">testTread3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestTread3</span><span class="o">();</span>
        <span class="n">testTread3</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
        <span class="n">testTread3</span><span class="o">.</span><span class="na">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main thread is exiting&#34;</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestTread3</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
        <span class="c1">//        boolean flag = true;//子线程不会停止
</span><span class="c1"></span>        <span class="kd">volatile</span> <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span><span class="c1">//用volatile修饰的变量可以及时在各线程里面通知
</span><span class="c1"></span>        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">flag</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">i</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;test thread is exiting&#34;</span><span class="o">);</span>

        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>关键步骤加锁限制
<ul>
<li>互斥：某一个线程运行一个代码段（关键区），其他线程不能同时运行这个代码段</li>
<li>同步：多个线程的运行，必须按照某一种规定的先后顺序来运行</li>
<li>互斥是同步的一种特例</li>
</ul>
</li>
<li>互斥的关键字是synchronized
<ul>
<li>synchronized代码块/函数，只能一个线程进入</li>
<li>synchronized能加大性能负担，但是使用简便</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.message</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 21:16
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadDemo3</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestThread3</span> <span class="n">testThread3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestThread3</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">testThread3</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">testThread3</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">testThread3</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">testThread3</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestThread3</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">volatile</span> <span class="kt">int</span> <span class="n">tickets</span> <span class="o">=</span> <span class="n">100</span><span class="o">;</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">tickets</span><span class="o">&gt;</span><span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">sale</span><span class="o">();</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>


            <span class="o">}</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">sale</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; sale &#34;</span> <span class="o">+</span> <span class="n">tickets</span><span class="o">--);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="多线程管理">多线程管理<a hidden class="anchor" aria-hidden="true" href="#多线程管理">#</a></h3>
<ul>
<li>
<p>线程状态</p>
<ul>
<li>NEW 刚创建（new）</li>
<li>RUNNABLE就绪态（start）</li>
<li>RUNNING运行中（run）</li>
<li>BLOCK阻塞（sleep）</li>
<li>TERMINATED 结束</li>
</ul>
</li>
<li>
<p>Thread的部分API已经废弃</p>
<ul>
<li>暂停和恢复：suspend/resume</li>
<li>消亡：stop/destroy</li>
</ul>
</li>
<li>
<p>线程阻塞/和唤醒</p>
<ul>
<li>sleep，时间一到，自己就会醒来</li>
<li>wait/notify/notifyAll，等待，需要别人来唤醒</li>
<li>join，等待另一个线程结束</li>
<li>interrupt，向另外一个线程发送中断信号，该线程收到信号，会触发
Interrupted Exception（可接触阻塞），并进入下一步处理</li>
</ul>
</li>
<li>
<p>线程类</p>
</li>
<li>
<p>主动interrupt</p>
</li>
<li>
<p>被动interrupt</p>
</li>
<li>
<p>多线程死锁</p>
<ul>
<li>每个线程相互持有别人需要的锁（哲学家吃面问题）</li>
<li>预防死锁，对资源进行等级排序</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Interrupt</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/4/7 0007 22:05
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeadLock</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Integer</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Integer</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Thread1</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread1</span><span class="o">();</span>
        <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">Thread2</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread2</span><span class="o">();</span>
        <span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Thread1</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//先要r1再要r2
</span><span class="c1"></span>        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">DeadLock</span><span class="o">.</span><span class="na">r1</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">DeadLock</span><span class="o">.</span><span class="na">r2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Thread1 is running&#34;</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Thread2</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//先要r2再要r1
</span><span class="c1"></span>        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">DeadLock</span><span class="o">.</span><span class="na">r2</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">DeadLock</span><span class="o">.</span><span class="na">r1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Thread2 is running&#34;</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>守护（后台）线程
<ul>
<li>普通线程的结束，是run方法运行结束</li>
<li>守护线程的结束，是run方法运行结束，或main函数结束</li>
<li>守护线程永远不要访问资源，如文件或数据库等</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Interrupt</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/4/7 0007 22:19
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">protect</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">Thread3</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread3</span><span class="o">();</span>
        <span class="n">t</span><span class="o">.</span><span class="na">setDaemon</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">2000</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main thread is exiting&#34;</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Thread3</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">300</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;running&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>线程查看工具jvisualvm</li>
</ul>
<h3 id="并发框架">并发框架<a hidden class="anchor" aria-hidden="true" href="#并发框架">#</a></h3>
<ul>
<li>
<p>业务：任务多，数据量大</p>
</li>
<li>
<p>串行 并行</p>
<ul>
<li>串行编程简单，并行编程困难</li>
<li>单个计算核频率下降，计算核数增多，整体性能变高</li>
</ul>
</li>
<li>
<p>并行困难（任务分配和执行过程高度耦合）</p>
<ul>
<li>如何控制粒度，切割任务</li>
<li>如何分配任务给线程，监督线程执行过程</li>
</ul>
</li>
</ul>
<h3 id="并行计算">并行计算<a hidden class="anchor" aria-hidden="true" href="#并行计算">#</a></h3>
<ul>
<li>并行模式
<ul>
<li>主从模式(Master-Slave)</li>
<li>Worker模式(Worker-Worker)</li>
</ul>
</li>
<li>Java并发编程
<ul>
<li>Thread/Runnable/Thread组管理</li>
<li>Executor(重点)</li>
<li>Fork-Join框架</li>
</ul>
</li>
</ul>
<h3 id="线程组管理">线程组管理<a hidden class="anchor" aria-hidden="true" href="#线程组管理">#</a></h3>
<ul>
<li>线程组ThreadGroup
<ul>
<li>线程的集合</li>
<li>树形结构,大线程可以包括小线程组</li>
<li>可以通过enumerate方法遍历组内的线程,执行操作</li>
<li>能够有效管理多个线程,但是管理效率低</li>
<li>任务分配和执行过程高度耦合</li>
<li>重复创建线程,关闭线程操作,无法重用线程</li>
</ul>
</li>
</ul>
<h3 id="executor">Executor*<a hidden class="anchor" aria-hidden="true" href="#executor">#</a></h3>
<ul>
<li>从jdk5开始提供Executor FrameWork
<ul>
<li>分离任务的创建和执行者的创建</li>
<li>线程重复利用(new线程代价很大)</li>
</ul>
</li>
<li>理解共享线程池的概念
<ul>
<li>预设好的多个Thread,可弹性增加</li>
<li>多次执行很多很小的任务</li>
<li>任务创建和执行过程解耦</li>
<li>程序员无需关心线程池执行任务过程</li>
</ul>
</li>
</ul>
<p>Main:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Executor.example2</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Future</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ThreadPoolExecutor</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-04-08 22:15
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SumTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//执行线程池
</span><span class="c1"></span>        <span class="n">ThreadPoolExecutor</span> <span class="n">executor</span> <span class="o">=</span> <span class="o">(</span><span class="n">ThreadPoolExecutor</span><span class="o">)</span> <span class="n">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="c1">//统计1-1000总和,分成10个任务计算,提交任务
</span><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">SumTask</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SumTask</span><span class="o">(</span><span class="n">i</span><span class="o">*</span><span class="n">100</span><span class="o">+</span><span class="n">1</span><span class="o">,(</span><span class="n">i</span><span class="o">+</span><span class="n">1</span><span class="o">)*</span><span class="n">100</span><span class="o">);</span>
            <span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="n">calculator</span><span class="o">);</span>
            <span class="n">resultList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//每隔50毫秒,轮询等待10个任务结束
</span><span class="c1"></span>        <span class="k">do</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main:已经完成了多少个任务:%d\n&#34;</span><span class="o">,</span> <span class="n">executor</span><span class="o">.</span><span class="na">getCompletedTaskCount</span><span class="o">());</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">resultList</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">resultList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main Task %d:%s\n&#34;</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">isDone</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">50</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>

        <span class="o">}</span> <span class="k">while</span> <span class="o">(</span><span class="n">executor</span><span class="o">.</span><span class="na">getCompletedTaskCount</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">resultList</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="c1">//所有任务都已经结束,综合计算结果
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">resultList</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">resultList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">Integer</span> <span class="n">sum</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">sum</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
                <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="n">sum</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ExecutionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;1-1000的总和&#34;</span> <span class="o">+</span> <span class="n">total</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>SumTask:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Executor.example2</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-04-08 22:17
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SumTask</span> <span class="kd">implements</span> <span class="n">Callable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">startNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">endNumber</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SumTask</span><span class="o">(</span><span class="kt">int</span> <span class="n">startNumber</span><span class="o">,</span> <span class="kt">int</span> <span class="n">endNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">startNumber</span> <span class="o">=</span> <span class="n">startNumber</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">endNumber</span> <span class="o">=</span> <span class="n">endNumber</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">startNumber</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">endNumber</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="k">new</span> <span class="n">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">1000</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;%s:%d&#34;</span><span class="o">,</span> <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">sum</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="fork-join">Fork-Join<a hidden class="anchor" aria-hidden="true" href="#fork-join">#</a></h3>
<ul>
<li>关键类
<ul>
<li>ForkJoinPool 任务池</li>
<li>RecursiveAction</li>
<li>RecursiveTask
Main:</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Fork_Join</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ForkJoinPool</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ForkJoinTask</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-04-09 13:37
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SumTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ExecutionException</span><span class="o">,</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="c1">//创建执行线程池
</span><span class="c1"></span>        <span class="n">ForkJoinPool</span> <span class="n">pool</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ForkJoinPool</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>
        <span class="c1">//创建任务
</span><span class="c1"></span>        <span class="n">SumTask</span> <span class="n">task</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SumTask</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">1000000</span><span class="o">);</span>
        <span class="c1">//提交任务
</span><span class="c1"></span>        <span class="n">ForkJoinTask</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="n">task</span><span class="o">);</span>
        <span class="c1">//等待结果
</span><span class="c1"></span>        <span class="k">do</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main:Thread Count:%d\n&#34;</span><span class="o">,</span> <span class="n">pool</span><span class="o">.</span><span class="na">getActiveThreadCount</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main:Parallelism:%d\n&#34;</span><span class="o">,</span> <span class="n">pool</span><span class="o">.</span><span class="na">getParallelism</span><span class="o">());</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">50</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">while</span> <span class="o">(!</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">());</span>
        <span class="c1">//输出结果
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>SumTask</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.thread.Fork_Join</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ForkJoinPool</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ForkJoinTask</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-04-09 13:37
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SumTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ExecutionException</span><span class="o">,</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="c1">//创建执行线程池
</span><span class="c1"></span>        <span class="n">ForkJoinPool</span> <span class="n">pool</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ForkJoinPool</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>
        <span class="c1">//创建任务
</span><span class="c1"></span>        <span class="n">SumTask</span> <span class="n">task</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SumTask</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">1000000</span><span class="o">);</span>
        <span class="c1">//提交任务
</span><span class="c1"></span>        <span class="n">ForkJoinTask</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="n">task</span><span class="o">);</span>
        <span class="c1">//等待结果
</span><span class="c1"></span>        <span class="k">do</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main:Thread Count:%d\n&#34;</span><span class="o">,</span> <span class="n">pool</span><span class="o">.</span><span class="na">getActiveThreadCount</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Main:Parallelism:%d\n&#34;</span><span class="o">,</span> <span class="n">pool</span><span class="o">.</span><span class="na">getParallelism</span><span class="o">());</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">50</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">while</span> <span class="o">(!</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">());</span>
        <span class="c1">//输出结果
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="主要类">主要类<a hidden class="anchor" aria-hidden="true" href="#主要类">#</a></h4>
<ul>
<li>ExecutorService,ThreadPoolExecutor,Future
<ul>
<li>Executors.newCachedThreadPool/newFixedThreadPool创建线程池</li>
<li>ExecutorService线程池服务</li>
<li>Callable 具体的逻辑对象(线程类)</li>
<li>Future返回结果</li>
</ul>
</li>
</ul>
<h3 id="并发数据结构">并发数据结构<a hidden class="anchor" aria-hidden="true" href="#并发数据结构">#</a></h3>
<ul>
<li>阻塞式集合:当集合为空或者满时,等待</li>
<li>非阻塞式集合:当集合为空或者满时,不等待,返回null或异常</li>
</ul>
<p>-List
- Vector 同步安全,写多读少
- ArrayList 不安全
- Collections.synchronizedList(List list) 基于synchronized,效率差
- CopyOnWriteArrayList 读多写少,基于复制机制,非阻塞</p>
<ul>
<li>Set
<ul>
<li>HashSet不安全</li>
<li>Collections.synchronizedSet(Set set)基于synchronized,效率差</li>
<li>CopyOnWriteArraySet (基于CopyOnWriteArrayList实现),读多写少,非阻塞</li>
</ul>
</li>
<li>Map
<ul>
<li>Hashtable 同步安全,写多读少</li>
<li>HashMap 不安全</li>
<li>Collections.synchronizedMap(Map map)基于synchronized,效率差</li>
<li>ConcurrentHashMap,读多写少,非阻塞</li>
</ul>
</li>
<li>Queue&amp;Deque
<ul>
<li>ConcurrentLinkedQueue非阻塞</li>
<li>ArrayBlockingQueue/LinkedBlockingQueue阻塞</li>
</ul>
</li>
</ul>
<h3 id="并发协作与控制">并发协作与控制<a hidden class="anchor" aria-hidden="true" href="#并发协作与控制">#</a></h3>
<h4 id="lock">Lock<a hidden class="anchor" aria-hidden="true" href="#lock">#</a></h4>
<blockquote>
<p>买奶茶,读写锁,互斥锁</p>
</blockquote>
<ul>
<li>Lock也可以实现同步的效果
<ul>
<li>实现更复杂的临界区结构</li>
<li>tryLock方法可以预判锁是否空闲</li>
<li>允许分离读写的操作,多个读,一个写</li>
<li>性能更好</li>
</ul>
</li>
<li>ReentrantLock 类,可重入的互斥锁</li>
<li>ReentrantReadWriteLock类,可重入的读写锁</li>
<li>lock和unlock函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.Lock</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.ReentrantLock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.ReentrantReadWriteLock</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-07 16:41
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LockExample</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ReentrantLock</span> <span class="n">queueLock</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ReentrantLock</span><span class="o">();</span><span class="c1">//可重入锁
</span><span class="c1"></span>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ReentrantReadWriteLock</span> <span class="n">orderLock</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ReentrantReadWriteLock</span><span class="o">();</span><span class="c1">//可读写锁
</span><span class="c1"></span>
    <span class="cm">/**
</span><span class="cm">     * 有家奶茶店,点单时需要排队
</span><span class="cm">     * 假设想买奶茶的人如果看到需要排队就等等
</span><span class="cm">     * 假设奶茶店又老板和多名员工,记单方式比较原始,只有一个订单本
</span><span class="cm">     * 老板负责写新订单,员工不断查看订单本得到信息来制作奶茶,在老板写订单时员工不可以看订单本
</span><span class="cm">     * 多个员工可同时看订单本,但此时老板不可写入订单本
</span><span class="cm">     * @param args args
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>  <span class="o">{</span>
<span class="c1">//        byMilkTea();
</span><span class="c1"></span>        <span class="n">handleOrder</span><span class="o">();</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">byMilkTea</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">LockExample</span> <span class="n">lockExample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LockExample</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">CUSTOMER_CNT</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
        <span class="n">Thread</span><span class="o">[]</span> <span class="n">customers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">[</span><span class="n">CUSTOMER_CNT</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CUSTOMER_CNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">customers</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="kt">long</span> <span class="n">walkingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">walkingTime</span><span class="o">);</span>
                        <span class="n">lockExample</span><span class="o">.</span><span class="na">tryToBuyMilkTea</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">customers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">tryToBuyMilkTea</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">flag</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">queueLock</span><span class="o">.</span><span class="na">tryLock</span><span class="o">())</span> <span class="o">{</span>
<span class="c1">//                queueLock.lock();
</span><span class="c1"></span>                <span class="kt">long</span> <span class="n">thinkingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">500</span><span class="o">);</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">thinkingTime</span><span class="o">);</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;:来一杯奶茶,不要珍珠&#34;</span><span class="o">);</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="n">queueLock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;:再等等&#34;</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">flag</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">handleOrder</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">LockExample</span> <span class="n">lockExample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LockExample</span><span class="o">();</span>
        <span class="n">Thread</span> <span class="n">boss</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">lockExample</span><span class="o">.</span><span class="na">addOrder</span><span class="o">();</span>
                        <span class="kt">long</span> <span class="n">waitingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">waitingTime</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">}</span>

            <span class="o">}</span>

        <span class="o">});</span>
        <span class="n">boss</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">WORKER_CNT</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span>
        <span class="n">Thread</span><span class="o">[]</span> <span class="n">workers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">[</span><span class="n">WORKER_CNT</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">WORKER_CNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">workers</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">try</span> <span class="o">{</span>
                            <span class="n">lockExample</span><span class="o">.</span><span class="na">viewOrder</span><span class="o">();</span>
                            <span class="kt">long</span> <span class="n">workingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">5000</span><span class="o">);</span>
                            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">workingTime</span><span class="o">);</span>
                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">workers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span>

        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">viewOrder</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">orderLock</span><span class="o">.</span><span class="na">readLock</span><span class="o">().</span><span class="na">lock</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">readingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">500</span><span class="o">);</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">readingTime</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;:查看订单&#34;</span><span class="o">);</span>
        <span class="n">orderLock</span><span class="o">.</span><span class="na">readLock</span><span class="o">().</span><span class="na">unlock</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addOrder</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">orderLock</span><span class="o">.</span><span class="na">writeLock</span><span class="o">().</span><span class="na">lock</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">writingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">writingTime</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;老板新加一笔订单&#34;</span><span class="o">);</span>
        <span class="n">orderLock</span><span class="o">.</span><span class="na">writeLock</span><span class="o">().</span><span class="na">unlock</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="semaphore">Semaphore<a hidden class="anchor" aria-hidden="true" href="#semaphore">#</a></h4>
<blockquote>
<p>抢车位,车位满了不可停车,其他等着</p>
</blockquote>
<ul>
<li>信号量:由1965年Dijkstra提出</li>
<li>信号量:本质上是一个计数器</li>
<li>计数器大于0,可以使用,等于0不能使用</li>
<li>可以设置多个并发量,例如限制10个访问</li>
<li>Semaphore
<ul>
<li>acquire获取</li>
<li>release释放</li>
</ul>
</li>
<li>比lock更进一步,可以控制多个同时访问关键区</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.Semaphore</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.Semaphore</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-07 17:48
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SemaphoreExample</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Semaphore</span> <span class="n">placeSemaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Semaphore</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">parking</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">placeSemaphore</span><span class="o">.</span><span class="na">tryAcquire</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;停车成功&#34;</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;没有空位&#34;</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">leaving</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">placeSemaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;:开走&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * 一个车库,五个车位,十辆车需要停放,每次停放时,申请信号量
</span><span class="cm">     * @param args args
</span><span class="cm">     * @throws InterruptedException exception
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">tryToParkCnt</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
        <span class="n">SemaphoreExample</span> <span class="n">semaphoreExample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SemaphoreExample</span><span class="o">();</span>
        <span class="n">Thread</span><span class="o">[]</span> <span class="n">parkers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">[</span><span class="n">tryToParkCnt</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tryToParkCnt</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">parkers</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="kt">long</span> <span class="n">randomTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">randomTime</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">semaphoreExample</span><span class="o">.</span><span class="na">parking</span><span class="o">())</span> <span class="o">{</span>
                            <span class="kt">long</span> <span class="n">parkingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
                            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">parkingTime</span><span class="o">);</span>
                            <span class="n">semaphoreExample</span><span class="o">.</span><span class="na">leaving</span><span class="o">();</span>
                        <span class="o">}</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">parkers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span>

        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tryToParkCnt</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">parkers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">join</span><span class="o">();</span>
        <span class="o">}</span>


    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="latch">latch<a hidden class="anchor" aria-hidden="true" href="#latch">#</a></h4>
<blockquote>
<p>百米赛跑,发令枪归零同时起跑(startSignal),运动员依次就位(doneSignal)</p>
</blockquote>
<ul>
<li>等待锁,是一个同步辅助类</li>
<li>用来同步执行任务的一个或者多个线程</li>
<li>不是用来保护临界区或者资源共享</li>
<li>CountDownLatch
<ul>
<li>countDown() 计数-1</li>
<li>await() 等待latch变成0</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.CountDownLatch</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.CountDownLatch</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-08 10:58
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountDownLatchExample</span> <span class="o">{</span>
    <span class="cm">/**
</span><span class="cm">     * 设想百米赛跑比赛,发令枪发出信号后选手开始跑,全部选手跑到终点后比赛结束
</span><span class="cm">     * @param args args
</span><span class="cm">     * @throws InterruptedException Interrupted Exception
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">runnerCnt</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
        <span class="n">CountDownLatch</span> <span class="n">startSignal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CountDownLatch</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
        <span class="n">CountDownLatch</span> <span class="n">doneSignal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CountDownLatch</span><span class="o">(</span><span class="n">runnerCnt</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">runnerCnt</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span><span class="c1">//create and start threads
</span><span class="c1"></span>            <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Worker</span><span class="o">(</span><span class="n">startSignal</span><span class="o">,</span><span class="n">doneSignal</span><span class="o">)).</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;准备工作&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;准备工作就绪&#34;</span><span class="o">);</span>
        <span class="n">startSignal</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span><span class="c1">//let all thread proceed
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;比赛开始&#34;</span><span class="o">);</span>
        <span class="n">doneSignal</span><span class="o">.</span><span class="na">await</span><span class="o">();</span><span class="c1">//wait for all to finish
</span><span class="c1"></span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Worker</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">CountDownLatch</span> <span class="n">startSignal</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">CountDownLatch</span> <span class="n">downSignal</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">Worker</span><span class="o">(</span><span class="n">CountDownLatch</span> <span class="n">startSignal</span><span class="o">,</span> <span class="n">CountDownLatch</span> <span class="n">downSignal</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">startSignal</span> <span class="o">=</span> <span class="n">startSignal</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">downSignal</span> <span class="o">=</span> <span class="n">downSignal</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">startSignal</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">((</span><span class="kt">long</span><span class="o">)(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="n">500</span><span class="o">));</span>
                <span class="n">doWork</span><span class="o">();</span>
                <span class="n">downSignal</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//return;
</span><span class="c1"></span>            <span class="o">}</span>

        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doWork</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;:跑完全程&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="barrier">Barrier<a hidden class="anchor" aria-hidden="true" href="#barrier">#</a></h4>
<blockquote>
<p>分步计算总和</p>
</blockquote>
<ul>
<li>集合点,也是一个同步辅助类</li>
<li>允许多个线程在某一个点上进行同步</li>
<li>CyclicBarrier
<ul>
<li>构造函数是需要同步的线程数量</li>
<li>await等待其他线程,达到数量后就放行</li>
</ul>
</li>
</ul>
<h4 id="phaser">Phaser<a hidden class="anchor" aria-hidden="true" href="#phaser">#</a></h4>
<ul>
<li>允许执行并发多阶段任务,同步辅助类</li>
<li>在每一个阶段结束的位置对线程进行同步,当所有线程都到达这步,再进行下一步</li>
<li>Phaser
<ul>
<li>arrive()</li>
<li>arriveAndAwaitAdvance()</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.Phaser</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.Phaser</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-08 19:46
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PhaserExample</span> <span class="o">{</span>
    <span class="cm">/**
</span><span class="cm">     * 假设举行考试,总共三个答题,每次下发一道题目,等所有学生完成后再进行下一道
</span><span class="cm">     * @param args
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">STUDENT_CNT</span> <span class="o">=</span> <span class="n">5</span><span class="o">;</span>
        <span class="n">Phaser</span> <span class="n">phaser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Phaser</span><span class="o">(</span><span class="n">STUDENT_CNT</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">STUDENT_CNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Student</span><span class="o">(</span><span class="n">phaser</span><span class="o">)).</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">Phaser</span> <span class="n">phaser</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Student</span><span class="o">(</span><span class="n">Phaser</span> <span class="n">phaser</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">phaser</span> <span class="o">=</span> <span class="n">phaser</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">doTesting</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
                <span class="n">phaser</span><span class="o">.</span><span class="na">arriveAndAwaitAdvance</span><span class="o">();</span>
                <span class="n">doTesting</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
                <span class="n">phaser</span><span class="o">.</span><span class="na">arriveAndAwaitAdvance</span><span class="o">();</span>
                <span class="n">doTesting</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
                <span class="n">phaser</span><span class="o">.</span><span class="na">arriveAndAwaitAdvance</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>

        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doTesting</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#34;开始第&#34;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&#34;题&#34;</span><span class="o">);</span>
            <span class="kt">long</span> <span class="n">thinkingTime</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="n">1000</span><span class="o">);</span>
            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">thinkingTime</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;%s第%d到题答题结束\n&#34;</span><span class="o">,</span><span class="n">name</span><span class="o">,</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="exchanger">Exchanger<a hidden class="anchor" aria-hidden="true" href="#exchanger">#</a></h4>
<blockquote>
<p>双向交换数据</p>
</blockquote>
<ul>
<li>允许在并发线程中相互交换消息</li>
<li>允许在2个线程种定义同步点,当两个线程都达到同步点,他们交换数据结构</li>
<li>Exchanger
<ul>
<li>exchange(),线程双方互相交换数据</li>
<li>交换数据是双向的</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.Exchanger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Exchanger</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-10 17:16
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExchangerExample</span> <span class="o">{</span>
    <span class="cm">/**
</span><span class="cm">     * 通过Exchanger实现学生成绩查询,简单线程间的数据交换
</span><span class="cm">     * @param args
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">exchanger</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">BackgroundWorker</span> <span class="n">worker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BackgroundWorker</span><span class="o">(</span><span class="n">exchanger</span><span class="o">);</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">worker</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
        <span class="n">Scanner</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;输出要查询的的属性学生姓名:&#34;</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">input</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextLine</span><span class="o">().</span><span class="na">trim</span><span class="o">();</span>
            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">&#34;exit&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;查询结果&#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>

        <span class="o">}</span>
        <span class="n">reader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BackgroundWorker</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="o">{</span>
        <span class="kd">final</span> <span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">exchanger</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">BackgroundWorker</span><span class="o">(</span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">exchanger</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">exchanger</span> <span class="o">=</span> <span class="n">exchanger</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">String</span> <span class="n">item</span> <span class="o">=</span> <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
                    <span class="k">switch</span> <span class="o">(</span><span class="n">item</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">case</span> <span class="s">&#34;zhangsan&#34;</span><span class="o">:</span>
                            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="s">&#34;90&#34;</span><span class="o">);</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="k">case</span> <span class="s">&#34;lisi&#34;</span><span class="o">:</span>
                            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="s">&#34;80&#34;</span><span class="o">);</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="k">case</span> <span class="s">&#34;wangwu&#34;</span><span class="o">:</span>
                            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="s">&#34;70&#34;</span><span class="o">);</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="k">case</span> <span class="s">&#34;exit&#34;</span><span class="o">:</span>
                            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="s">&#34;exit&#34;</span><span class="o">);</span>
                        <span class="k">default</span><span class="o">:</span>
                            <span class="n">exchanger</span><span class="o">.</span><span class="na">exchange</span><span class="o">(</span><span class="s">&#34;none&#34;</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

                <span class="o">}</span>
            <span class="o">}</span>

        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="定时任务">定时任务<a hidden class="anchor" aria-hidden="true" href="#定时任务">#</a></h3>
<ul>
<li>简单定时机制
<ul>
<li>设置计划任务,也就是在指定的时间开始执行某一个任务</li>
<li>TimerTask封装任务</li>
<li>Timer类 定时器</li>
</ul>
</li>
<li>Timer</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">notes.Java.JavaLearning_Advanced.thread.Timer</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Timer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.TimerTask</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020-05-10 17:42
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimerTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">MyTask</span> <span class="n">myTask</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyTask</span><span class="o">();</span>
        <span class="n">Timer</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Timer</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;当前时间:&#34;</span> <span class="o">+</span> <span class="k">new</span> <span class="n">Date</span><span class="o">().</span><span class="na">toLocaleString</span><span class="o">());</span>
        <span class="c1">//当前时间一秒后,每两秒执行一次
</span><span class="c1"></span>        <span class="n">timer</span><span class="o">.</span><span class="na">schedule</span><span class="o">(</span><span class="n">myTask</span><span class="o">,</span><span class="n">1000</span><span class="o">,</span><span class="n">2000</span><span class="o">);</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">10000</span><span class="o">);</span>
        <span class="n">myTask</span><span class="o">.</span><span class="na">cancel</span><span class="o">();</span><span class="c1">//取消当前任务
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;==============&#34;</span><span class="o">);</span>
        <span class="n">Calendar</span> <span class="n">now</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
        <span class="n">now</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">SECOND</span><span class="o">,</span> <span class="n">now</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">SECOND</span><span class="o">)</span> <span class="o">+</span> <span class="n">3</span><span class="o">);</span>
        <span class="n">Date</span> <span class="n">runDate</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="na">getTime</span><span class="o">();</span>
        <span class="n">MyTask2</span> <span class="n">myTask2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyTask2</span><span class="o">();</span>
        <span class="n">timer</span><span class="o">.</span><span class="na">scheduleAtFixedRate</span><span class="o">(</span><span class="n">myTask2</span><span class="o">,</span><span class="n">runDate</span><span class="o">,</span><span class="n">3000</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyTask</span> <span class="kd">extends</span> <span class="n">TimerTask</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;运行了!时间为:&#34;</span><span class="o">+</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyTask2</span> <span class="kd">extends</span> <span class="n">TimerTask</span><span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;运行了!时间为:&#34;</span><span class="o">+</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">4000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>Executor+定时器机制</li>
<li>ScheduledExecutorService
<ul>
<li>定时任务</li>
<li>周期任务</li>
</ul>
</li>
<li>Quartz
<ul>
<li>Quartz是一个较为完善的任务调度框架</li>
<li>解决程序中Timer零散管理的问题</li>
<li>功能更加强大
<ul>
<li>Timer执行周期任务,如果中间有一次有一场,整个任务终止执行</li>
<li>Quartz执行周期任务,如果中间某一次有异常,不影响下次任务执行</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>​</p>
<h2 id="java网络编程">Java网络编程<a hidden class="anchor" aria-hidden="true" href="#java网络编程">#</a></h2>
<h3 id="网络基础知识">网络基础知识<a hidden class="anchor" aria-hidden="true" href="#网络基础知识">#</a></h3>
<ul>
<li>
<p>网络是当前信息技术的第一推动力</p>
</li>
<li>
<p>每个计算设备上都有若干个网卡</p>
</li>
<li>
<p>每个网卡上有（全球唯一）单独的硬件地址，MAC地址</p>
</li>
<li>
<p>ip地址</p>
<ul>
<li>IPV4 192.169.0.1每段0-255</li>
<li>IPV6 128bit长，8段，每段4个16进制数</li>
<li>ipconfig ifconfig</li>
</ul>
</li>
<li>
<p>port:端口 0~65535</p>
<ul>
<li>0~1023OS已经占用了，80是web，23是telnet</li>
<li>1024~65535，一般程序可使用（谨防冲突）</li>
</ul>
</li>
<li>
<p>两台机器通讯就是在IP+port上进行的</p>
<ul>
<li>netstat -an</li>
</ul>
</li>
<li>
<p>保留ip：127.0.0.1 本机</p>
</li>
<li>
<p>公网（万维网/互联网）和内网（局域网）</p>
<ul>
<li>网络上分层的</li>
<li>最外层的是外网/互联网</li>
<li>底下每层都是内网</li>
<li>ip地址可以在每个层次的网重用</li>
<li>tracert 看当前及其和目标机器的访问中继</li>
</ul>
</li>
<li>
<p>通讯协议TCP UDP</p>
<ul>
<li>TCP(Transmission Control Protocol)
<ul>
<li>传输控制协议，面向连接的协议</li>
<li>两台机器的可靠无差错的数据传输</li>
<li>双向字节流传递</li>
</ul>
</li>
<li>UDP(User Datagram Protocol)   &ndash;&gt;QQ(多次UDP模仿TCP)</li>
<li>用户数据报协议，面向无连接协议</li>
<li>不保证可靠的数据传输</li>
<li>速度快，也可以在较差的网络下使用</li>
</ul>
</li>
</ul>
<h3 id="udp">UDP<a hidden class="anchor" aria-hidden="true" href="#udp">#</a></h3>
<ul>
<li>计算机通讯：数据从一个IP的port出发（发送方），运输到另外一个IP的port（接收方）</li>
<li>UDP：无连接无状态的通讯协议
<ul>
<li>发送方发送消息，如果接收方刚好在目的地，则可以接受，如果不在
那这个消息就丢失了</li>
<li>发送方也无法得知是否发送成功</li>
<li>UDP的好处就是简单节省，经济</li>
</ul>
</li>
</ul>
<h4 id="实例">实例<a hidden class="anchor" aria-hidden="true" href="#实例">#</a></h4>
<ul>
<li>DatagramSocket:通讯的数据管道
<ul>
<li>send和receive方法</li>
<li>（可选，多网卡）绑定一个IP和Port</li>
</ul>
</li>
<li>DatagramPacket
<ul>
<li>集装箱：封装数据</li>
<li>地址标签：目的地IP+Port
Receive:</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.UDP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.DatagramPacket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.DatagramSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.SocketException</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description: receive
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 0:23
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UdpRecv</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">DatagramSocket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramSocket</span><span class="o">(</span><span class="n">3000</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="o">];</span>
        <span class="n">DatagramPacket</span> <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="o">(</span><span class="n">buf</span><span class="o">,</span><span class="n">buf</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpRecv：等待信息&#34;</span><span class="o">);</span>
        <span class="n">socket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">packet</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpRecv:已接受信息&#34;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">strRecv</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">packet</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="n">0</span><span class="o">,</span> <span class="n">packet</span><span class="o">.</span><span class="na">getLength</span><span class="o">())</span> <span class="o">+</span> <span class="s">&#34;from&#34;</span> <span class="o">+</span> <span class="n">packet</span><span class="o">.</span><span class="na">getAddress</span><span class="o">().</span><span class="na">getHostAddress</span><span class="o">()</span>
                <span class="o">+</span> <span class="s">&#34;:&#34;</span> <span class="o">+</span> <span class="n">packet</span><span class="o">.</span><span class="na">getPort</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">strRecv</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&#34;nice to meet you!!&#34;</span><span class="o">;</span>
        <span class="n">DatagramPacket</span> <span class="n">packet1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">packet</span><span class="o">.</span><span class="na">getAddress</span><span class="o">(),</span> <span class="n">packet</span><span class="o">.</span><span class="na">getPort</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpRecv:即将发送信息！&#34;</span><span class="o">);</span>
        <span class="n">socket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">packet1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpRecv:已发送&#34;</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>send:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.UDP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.DatagramPacket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.DatagramSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetAddress</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description: send
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 0:24
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UdpSend</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
        <span class="n">DatagramSocket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramSocket</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&#34;hi ,im a mini robot&#34;</span><span class="o">;</span>
        <span class="n">DatagramPacket</span> <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">InetAddress</span><span class="o">.</span><span class="na">getByName</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">),</span> <span class="n">3000</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpSend:我要发送信息了&#34;</span><span class="o">);</span>
        <span class="n">socket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">packet</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpSend: 发送完毕&#34;</span><span class="o">);</span>
        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="o">];</span>
        <span class="n">DatagramPacket</span> <span class="n">packet1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="o">(</span><span class="n">buf</span><span class="o">,</span> <span class="n">1024</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpSend：我在等待信息&#34;</span><span class="o">);</span>
        <span class="n">socket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">packet1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UdpSend：已收到信息&#34;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">packet1</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="n">0</span><span class="o">,</span> <span class="n">packet1</span><span class="o">.</span><span class="na">getLength</span><span class="o">())+</span><span class="s">&#34;from&#34;</span><span class="o">+</span><span class="n">packet1</span><span class="o">.</span><span class="na">getAddress</span><span class="o">().</span><span class="na">getHostAddress</span><span class="o">()</span>
                <span class="o">+</span><span class="s">&#34;:&#34;</span><span class="o">+</span><span class="n">packet1</span><span class="o">.</span><span class="na">getPort</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="tcp">TCP<a hidden class="anchor" aria-hidden="true" href="#tcp">#</a></h3>
<ul>
<li>
<p>TCP协议：有链接、保证可靠的无误差通讯</p>
<ol>
<li>服务器：创建一个ServerSocket，等待连接</li>
<li>客户机：创建一个Socket，连接到服务器</li>
<li>服务器：ServerSocket接收到连接，创建一个Socket和客户的Socket建立专线连接，后续服务器和客户机的对话
（这一对Socket）会在一个单独的线程（服务器端）上运行</li>
<li>服务器的ServerSocket继续等待连接，返回 i.</li>
</ol>
</li>
<li>
<p>软件服务器有两要求：</p>
<ol>
<li>它能够实现一定的功能</li>
<li>它必须在一个公开地址上对外提供服务</li>
</ol>
</li>
<li>
<p>ServerSocket：服务码头</p>
<ul>
<li>需要绑定Port</li>
<li>如果有多块网卡，需要绑定一个IP地址</li>
</ul>
</li>
<li>
<p>Socket：运输通道</p>
<ul>
<li>客户端需要绑定服务器的地址和Port</li>
<li>客户端往Socket输入流写入数据，送到服务端</li>
<li>客户端从Socket输出流取服务端过来的数据</li>
<li>服务器反之亦然</li>
</ul>
</li>
<li>
<p>过程：</p>
<ul>
<li>服务端等待响应时，处于阻塞状态</li>
<li>服务端可以同时响应多个客户端</li>
<li>服务端每接受一个客户端，就启动一个独立的线程与其对应</li>
<li>客户端或者服务端都可以选择关闭这条Socket通道</li>
<li>实例
<ul>
<li>服务端先启动，且一直保留</li>
<li>客户端后启动，可以先退出</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Server:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.TCP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 13:16
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TCPServer2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="o">(</span><span class="n">8001</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;来了一个client&#34;</span><span class="o">);</span>
                <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Worker</span><span class="o">(</span><span class="n">socket</span><span class="o">)).</span><span class="na">start</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Worker</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="o">{</span>
        <span class="kd">private</span> <span class="n">Socket</span> <span class="n">socket</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Worker</span><span class="o">(</span><span class="n">Socket</span> <span class="n">socket</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;服务人员已启动&#34;</span><span class="o">);</span>
                <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
                <span class="n">OutputStream</span> <span class="n">outputStream</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
                <span class="n">DataOutputStream</span> <span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataOutputStream</span><span class="o">(</span><span class="n">outputStream</span><span class="o">);</span>
                <span class="n">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">inputStream</span><span class="o">));</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">String</span> <span class="n">strWord</span> <span class="o">=</span> <span class="n">bufferedReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;client said:&#34;</span> <span class="o">+</span> <span class="n">strWord</span> <span class="o">+</span> <span class="s">&#34;:&#34;</span> <span class="o">+</span> <span class="n">strWord</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">strWord</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">&#34;quit&#34;</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">String</span> <span class="n">strEcho</span> <span class="o">=</span> <span class="n">strWord</span> <span class="o">+</span> <span class="s">&#34;666&#34;</span><span class="o">;</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;server said:&#34;</span> <span class="o">+</span> <span class="n">strWord</span> <span class="o">+</span> <span class="s">&#34;---------&gt;&#34;</span> <span class="o">+</span> <span class="n">strEcho</span><span class="o">);</span>
                    <span class="n">dos</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">strWord</span> <span class="o">+</span> <span class="s">&#34;---------&gt;&#34;</span> <span class="o">+</span><span class="n">strEcho</span><span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;line.separator&#34;</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="n">bufferedReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="n">dos</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Client:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.TCP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 11:47
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TcpClient</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="o">(</span><span class="n">InetAddress</span><span class="o">.</span><span class="na">getByName</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">),</span> <span class="n">8001</span><span class="o">);</span>
            <span class="c1">// 同一个通道，服务端输出流就是客户端的输入流，服务端的输入流，就是客户端的输出流
</span><span class="c1"></span>            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span><span class="c1">//开启通道的输入流
</span><span class="c1"></span>            <span class="n">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">inputStream</span><span class="o">));</span>
            <span class="n">OutputStream</span> <span class="n">outputStream</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span><span class="c1">//开启通道的输出流
</span><span class="c1"></span>            <span class="n">DataOutputStream</span> <span class="n">dataOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataOutputStream</span><span class="o">(</span><span class="n">outputStream</span><span class="o">);</span>
            <span class="n">BufferedReader</span> <span class="n">brKey</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">));</span>
            <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">strWord</span> <span class="o">=</span> <span class="n">brKey</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">strWord</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">&#34;quit&#34;</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;i want to sent &#34;</span><span class="o">+</span><span class="n">strWord</span><span class="o">);</span>
<span class="c1">//                    outputStream.write(strWord.getBytes(), 0, strWord.length());//可以这么写
</span><span class="c1"></span>                    <span class="n">dataOutputStream</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">strWord</span><span class="o">+</span><span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;line.separator&#34;</span><span class="o">));</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;server said&#34;</span><span class="o">+</span><span class="n">bufferedReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">());</span>

                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">dataOutputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">bufferedReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="http">HTTP<a hidden class="anchor" aria-hidden="true" href="#http">#</a></h3>
<ul>
<li>在浏览器输入URL地址</li>
<li>浏览器将连接到远程服务器（IP=Port(80)）</li>
<li>请求下载一个HTML文件下来，放到本地临时文件夹中</li>
<li>在浏览器显示出来</li>
</ul>
<h4 id="实例-1">实例<a hidden class="anchor" aria-hidden="true" href="#实例-1">#</a></h4>
<ul>
<li>URLConnection
<ul>
<li>获取资源的连接器</li>
<li>根据URL的openConnection()方法获得URLConnection</li>
<li>connect方法，建立和资源的联系通道</li>
<li>getInputStream方法，获取资源的内容</li>
</ul>
</li>
</ul>
<p>get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 14:14
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">URLConnectionGet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">urlName</span> <span class="o">=</span> <span class="s">&#34;http://www.baidu.com&#34;</span><span class="o">;</span>
            <span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">urlName</span><span class="o">);</span>
            <span class="n">URLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
            <span class="c1">//打印Http的头部信息
</span><span class="c1"></span>            <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getHeaderFields</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">headers</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">value</span> <span class="o">:</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span> <span class="o">+</span> <span class="s">&#34;:&#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="c1">//输出将要收到的内容属性信息
</span><span class="c1"></span>            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;-------------------&#34;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getContentType&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getContentType</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getContentLength&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getContentLength</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getContentEncoding&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getContentEncoding</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getDate&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getDate</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getExpiration&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getExpiration</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;getLastModified&#34;</span> <span class="o">+</span> <span class="n">connection</span><span class="o">.</span><span class="na">getLastModified</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;-------------------&#34;</span><span class="o">);</span>
            <span class="n">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span><span class="s">&#34;UTF-8&#34;</span><span class="o">));</span>
            <span class="c1">//输出收到的内容
</span><span class="c1"></span>            <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">bufferedReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">bufferedReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Post:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 14:42
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">URLConnectionPost</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;https://www.usps.com/go/ZipLookupAction.action&#34;</span><span class="o">;</span>
        <span class="n">Object</span> <span class="n">userAgent</span> <span class="o">=</span> <span class="s">&#34;Httpie/0.9.2&#34;</span><span class="o">;</span>
        <span class="n">Object</span> <span class="n">redirects</span> <span class="o">=</span> <span class="s">&#34;1&#34;</span><span class="o">;</span>
        <span class="n">CookieHandler</span><span class="o">.</span><span class="na">setDefault</span><span class="o">(</span><span class="k">new</span> <span class="n">CookieManager</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">CookiePolicy</span><span class="o">.</span><span class="na">ACCEPT_ALL</span><span class="o">));</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;tAddress&#34;</span><span class="o">,</span> <span class="s">&#34;1 Market Street&#34;</span><span class="o">);</span>
        <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;tCity&#34;</span><span class="o">,</span> <span class="s">&#34;San Francisco&#34;</span><span class="o">);</span>
        <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;sState&#34;</span><span class="o">,</span> <span class="s">&#34;CA&#34;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">doPost</span><span class="o">(</span><span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">url</span><span class="o">),</span> <span class="n">params</span><span class="o">,</span>
                <span class="n">userAgent</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">userAgent</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span>
                <span class="n">redirects</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="o">-</span><span class="n">1</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">redirects</span><span class="o">.</span><span class="na">toString</span><span class="o">()));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">doPost</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">nameValueParis</span><span class="o">,</span> <span class="n">String</span> <span class="n">userAgent</span><span class="o">,</span> <span class="kt">int</span> <span class="n">redirects</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">HttpURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">userAgent</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">&#34;User-Agent&#34;</span><span class="o">,</span> <span class="n">userAgent</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">redirects</span> <span class="o">&gt;=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setInstanceFollowRedirects</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//输出请求的参数
</span><span class="c1"></span>        <span class="k">try</span> <span class="o">(</span><span class="n">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrintWriter</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">()))</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">first</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">pair</span> <span class="o">:</span> <span class="n">nameValueParis</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
                <span class="c1">//参数必须这样拼接a=1&amp;b=2&amp;c=3
</span><span class="c1"></span>                <span class="k">if</span> <span class="o">(</span><span class="n">first</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="sc">&#39;&amp;&#39;</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
                <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
                <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="sc">&#39;=&#39;</span><span class="o">);</span>
                <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="n">String</span> <span class="n">encoding</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getContentEncoding</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">encoding</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">redirects</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">responseCode</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;responseCode:&#34;</span> <span class="o">+</span> <span class="n">responseCode</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="n">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_MOVED_PERM</span> <span class="o">||</span> <span class="n">responseCode</span> <span class="o">==</span> <span class="n">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_MOVED_TEMP</span> <span class="o">||</span>
                        <span class="n">responseCode</span> <span class="o">==</span> <span class="n">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_SEE_OTHER</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">String</span> <span class="n">location</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getHeaderField</span><span class="o">(</span><span class="s">&#34;Location&#34;</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">location</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">URL</span> <span class="n">base</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getURL</span><span class="o">();</span>
                        <span class="n">connection</span><span class="o">.</span><span class="na">disconnect</span><span class="o">();</span>
                        <span class="k">return</span> <span class="n">doPost</span><span class="o">(</span><span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">base</span><span class="o">,</span> <span class="n">location</span><span class="o">),</span> <span class="n">nameValueParis</span><span class="o">,</span> <span class="n">userAgent</span><span class="o">,</span> <span class="n">redirects</span> <span class="o">-</span> <span class="n">1</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">redirects</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">IOException</span><span class="o">(</span><span class="s">&#34;too many redirects&#34;</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="c1">//获取html内容
</span><span class="c1"></span>            <span class="n">StringBuilder</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
            <span class="k">try</span> <span class="o">(</span><span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="n">encoding</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">InputStream</span> <span class="n">err</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getErrorStream</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">err</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">try</span> <span class="o">(</span><span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">err</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="o">}</span>


    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="jdk-httpclient-jdk9新增jdk10更新jdk11正式发布">JDK HttpClient (JDK9新增，JDK10更新，JDK11正式发布)<a hidden class="anchor" aria-hidden="true" href="#jdk-httpclient-jdk9新增jdk10更新jdk11正式发布">#</a></h3>
<ul>
<li>java.net.http包</li>
<li>取代URLConnection</li>
<li>支持HTTP/1.1和HTTP/2</li>
<li>实现大部分HTTP方法</li>
<li>主要类
<ul>
<li>HttpClient</li>
<li>HttpRequest</li>
<li>HttpResponse</li>
</ul>
</li>
</ul>
<p>Get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP.HttpClient</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.URI</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpResponse</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 15:38
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKHttpClientGet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">doGet</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">HttpClient</span><span class="o">.</span><span class="na">newHttpClient</span><span class="o">();</span>
            <span class="n">HttpRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">(</span><span class="n">URI</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">&#34;http://www.baidu.com&#34;</span><span class="o">)).</span><span class="na">build</span><span class="o">();</span>
            <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">HttpResponse</span><span class="o">.</span><span class="na">BodyHandlers</span><span class="o">.</span><span class="na">ofString</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">());</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Post:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP.HttpClient</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.URI</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLEncoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpResponse</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 15:43
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKHttpClientPost</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">doPost</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">HttpClient</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
            <span class="n">HttpRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="n">URI</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">&#34;https://zh-tools.usps.com/zip-code-lookup.htm?byaddress&#34;</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&#34;User-Agent&#34;</span><span class="o">,</span> <span class="s">&#34;HTTPie/0.9.2&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&#34;Content-Type&#34;</span><span class="o">,</span> <span class="s">&#34;application/x-www-form-urlencoded;charset=utf-8&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="n">HttpRequest</span><span class="o">.</span><span class="na">BodyPublishers</span><span class="o">.</span><span class="na">ofString</span><span class="o">(</span>
                            <span class="s">&#34;tAdress=&#34;</span> <span class="o">+</span> <span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">&#34;1 Market Street&#34;</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">)</span> <span class="o">+</span>
                                    <span class="s">&#34;tCity=&#34;</span><span class="o">+</span> <span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">&#34;San Francisco&#34;</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">)</span> <span class="o">+</span>
                                    <span class="s">&#34;sState=&#34;</span><span class="o">+</span> <span class="s">&#34;CA&#34;</span><span class="o">)</span>
                    <span class="o">).</span><span class="na">build</span><span class="o">();</span>
            <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">HttpResponse</span><span class="o">.</span><span class="na">BodyHandlers</span><span class="o">.</span><span class="na">ofString</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">headers</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="httpcomponent">HttpComponent<a hidden class="anchor" aria-hidden="true" href="#httpcomponent">#</a></h3>
<p>Get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP.HttpComponet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.config.RequestConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpGet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.CloseableHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.HttpClients</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.util.EntityUtils</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 16:53
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HttpComponentsGet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CloseableHttpClient</span> <span class="n">httpClient</span> <span class="o">=</span> <span class="n">HttpClients</span><span class="o">.</span><span class="na">createDefault</span><span class="o">();</span>
        <span class="n">RequestConfig</span> <span class="n">requestConfig</span> <span class="o">=</span> <span class="n">RequestConfig</span><span class="o">.</span><span class="na">custom</span><span class="o">()</span>
                <span class="o">.</span><span class="na">setConnectionRequestTimeout</span><span class="o">(</span><span class="n">5000</span><span class="o">)</span><span class="c1">//设置超时时间
</span><span class="c1"></span>                <span class="o">.</span><span class="na">setConnectionRequestTimeout</span><span class="o">(</span><span class="n">5000</span><span class="o">)</span><span class="c1">//设置请求超时时间
</span><span class="c1"></span>                <span class="o">.</span><span class="na">setSocketTimeout</span><span class="o">(</span><span class="n">5000</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setRedirectsEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span><span class="c1">//默认允许自动重定向
</span><span class="c1"></span>                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="s">&#34;http://www.baidu.com&#34;</span><span class="o">);</span>
        <span class="n">httpGet</span><span class="o">.</span><span class="na">setConfig</span><span class="o">(</span><span class="n">requestConfig</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">strResult</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">httpClient</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">httpResponse</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getStatusCode</span><span class="o">()</span> <span class="o">==</span> <span class="n">200</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">strResult</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">(),</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span><span class="c1">//获得返回结果
</span><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">strResult</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Post;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">JavaLearning_Advanced.HTTP.HttpComponet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.config.RequestConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.entity.UrlEncodedFormEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.CloseableHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.HttpClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.LaxRedirectStrategy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.message.BasicNameValuePair</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.util.EntityUtils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLEncoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @Description:
</span><span class="cm"> * @author: Anhlaidh
</span><span class="cm"> * @date: 2020/3/29 0029 17:03
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HttpComponentsPost</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UnsupportedEncodingException</span> <span class="o">{</span>
        <span class="c1">//获取可关闭的httpClient
</span><span class="c1"></span>        <span class="c1">//CloseableHttpClient
</span><span class="c1"></span>        <span class="n">CloseableHttpClient</span> <span class="n">httpClient</span> <span class="o">=</span> <span class="n">HttpClientBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">().</span><span class="na">setRedirectStrategy</span><span class="o">(</span><span class="k">new</span> <span class="n">LaxRedirectStrategy</span><span class="o">()).</span><span class="na">build</span><span class="o">();</span>
        <span class="c1">//配置超时时间
</span><span class="c1"></span>        <span class="n">RequestConfig</span> <span class="n">requestConfig</span> <span class="o">=</span> <span class="n">RequestConfig</span><span class="o">.</span><span class="na">custom</span><span class="o">()</span>
                <span class="o">.</span><span class="na">setSocketTimeout</span><span class="o">(</span><span class="n">10000</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setConnectTimeout</span><span class="o">(</span><span class="n">10000</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setConnectionRequestTimeout</span><span class="o">(</span><span class="n">10000</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setRedirectsEnabled</span><span class="o">(</span><span class="kc">false</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
        <span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="s">&#34;https://zh-tools.usps.com/zip-code-lookup.htm?byaddress&#34;</span><span class="o">);</span>
        <span class="c1">//配置post参数
</span><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">BasicNameValuePair</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BasicNameValuePair</span><span class="o">(</span><span class="s">&#34;tAdress&#34;</span><span class="o">,</span> <span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">&#34;1 Market Street&#34;</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">)));</span><span class="c1">//请求参数
</span><span class="c1"></span>        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BasicNameValuePair</span><span class="o">(</span><span class="s">&#34;tCity&#34;</span><span class="o">,</span> <span class="n">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">&#34;San Francisco&#34;</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">)));</span><span class="c1">//请求参数
</span><span class="c1"></span>        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BasicNameValuePair</span><span class="o">(</span><span class="s">&#34;sState&#34;</span><span class="o">,</span> <span class="s">&#34;CA&#34;</span><span class="o">));</span><span class="c1">//请求参数
</span><span class="c1"></span>        <span class="k">try</span> <span class="o">{</span>
            <span class="n">UrlEncodedFormEntity</span> <span class="n">entity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UrlEncodedFormEntity</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>
            <span class="c1">// 设置post请求参数
</span><span class="c1"></span>            <span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">entity</span><span class="o">);</span>
            <span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">&#34;User-Agent&#34;</span><span class="o">,</span> <span class="s">&#34;HTTPie/0.9.2&#34;</span><span class="o">);</span>
            <span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">httpClient</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">httpResponse</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">statusCode</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getStatusCode</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">statusCode</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">statusCode</span> <span class="o">==</span> <span class="n">200</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">());</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="s">&#34;ERROR Response&#34;</span> <span class="o">+</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="o">}</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">httpClient</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">httpClient</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>

        <span class="o">}</span>

    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="java调用其他语言">Java调用其他语言<a hidden class="anchor" aria-hidden="true" href="#java调用其他语言">#</a></h2>
<h3 id="python">Python<a hidden class="anchor" aria-hidden="true" href="#python">#</a></h3>
<ul>
<li>解释性脚本语言</li>
<li>目前版本3</li>
<li>Jython
<ul>
<li>将Python源码编译成JVM字节码,由JVM执行对应的字节码,可以很好的与JVM继承</li>
<li>不是Java与Python的连接器</li>
</ul>
</li>
</ul>

</div>


  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://blog.oxide.ink/tags/first/">first</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://blog.oxide.ink/posts/demo/">
    <span class="title">« 上一页</span>
    <br>
    <span>Demo</span>
  </a>
</nav>


  </footer><section class="comments">

    <script src="https://utteranc.es/client.js"
            repo="Anhlaidh/Oxside"
            issue-term="pathname"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>

</section>

</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="http://blog.oxide.ink/">Oxide</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <br>
    <span>Anhlaidh
        <a href="#">chinahantianzhao@foxmail.com</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a><script src="https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js"></script>
<script>
    let parm1 = ''
    if (document.cookie.indexOf("uv=false") == -1) {
        parm1 = "&uv=true"
        var t = new Date(new Date().getTime() + 1000 * 60 * 60 * 24);
        document.cookie = "uv=false; expires=" + t.toGMTString() + ";path=/";
    }
    fetch("https://analytics.radishkin.workers.dev/api?url=" + window.btoa(location.href) + parm1).then(res => {
        return res.json()
    }).then(res => {
        try {
            document.getElementById("busuanzi_value_page_pv").innerText = res.pv
        } catch(err) {}
        try{
            document.getElementById("busuanzi_container_site_uv").innerText = res.uv
        }catch(err){}
        try{
            document.getElementById("busuanzi_container_site_pv").innerText = res.total
        }catch(err){}
    })

</script>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
